<?xml version="1.0" encoding="UTF-8"?>
<sql-group>
	<doc>
		<author></author>
		<date></date>
		<description>投诉情况分析报表</description>
	</doc>

	<!-- 投诉情况分析报表-升级-月 -->
	<sqlquery name="SQL_TS_TS_SJA.query">

		<select>
            <![CDATA[
	SELECT /*COUNT*/ A.* /*COUNT*/ FROM (
	SELECT
	ACPT_TIME,
	AREA_NAME,
	SJTOTAL_TOTAL,
	SJTOTAL_MARKET_PERSONAL,
	SJTOTAL_MARKET_FAMILY,
	SJTOTAL_MARKET_ENTERPRISE,
	SJTOTAL_NET_PERSONAL,
	SJTOTAL_NET_FAMILY,
	SJTOTAL_NET_ENTERPRISE,
	SJTOTAL_XA,
	to_char(round( ( decode( SJTOTAL_TOTAL, 0, 0, ( SJTOTAL_MARKET_PERSONAL + SJTOTAL_MARKET_FAMILY + SJTOTAL_MARKET_ENTERPRISE ) / SJTOTAL_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' SJTOTAL_MARKET_RAT,
	to_char(round( ( decode( SJTOTAL_TOTAL, 0, 0, ( SJTOTAL_NET_PERSONAL + SJTOTAL_NET_FAMILY + SJTOTAL_NET_ENTERPRISE ) / SJTOTAL_TOTAL )*100 ) , 2 ),'fm99999999990.00')||'%' SJTOTAL_NET_RAT,
	to_char(round( ( decode( SJTOTAL_TOTAL, 0, 0, ( SJTOTAL_XA ) / SJTOTAL_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' SJTOTAL_XA_RAT,
	
	NINE_TOTAL,
	NINE_MARKET_PERSONAL,
	NINE_MARKET_FAMILY,
	NINE_MARKET_ENTERPRISE,
	NINE_NET_PERSONAL,
	NINE_NET_FAMILY,
	NINE_NET_ENTERPRISE,
	NINE_XA,
	to_char(round( ( decode( NINE_TOTAL, 0, 0, ( NINE_MARKET_PERSONAL + NINE_MARKET_FAMILY + NINE_MARKET_ENTERPRISE ) / NINE_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' NINE_MARKET_RAT,
	to_char(round( ( decode( NINE_TOTAL, 0, 0, ( NINE_NET_PERSONAL + NINE_NET_FAMILY + NINE_NET_ENTERPRISE ) / NINE_TOTAL )*100 ) , 2 ),'fm99999999990.00')||'%' NINE_NET_RAT,
	to_char(round( ( decode( NINE_TOTAL, 0, 0, ( NINE_XA ) / NINE_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' NINE_XA_RAT,
	
	MIIT_TOTAL,
	MIIT_MARKET_PERSONAL,
	MIIT_MARKET_FAMILY,
	MIIT_MARKET_ENTERPRISE,
	MIIT_NET_PERSONAL,
	MIIT_NET_FAMILY,
	MIIT_NET_ENTERPRISE,
	MIIT_XA,
	to_char(round( ( decode( MIIT_TOTAL, 0, 0, ( MIIT_MARKET_PERSONAL + MIIT_MARKET_FAMILY + MIIT_MARKET_ENTERPRISE ) / MIIT_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' MIIT_MARKET_RAT,
	to_char(round( ( decode( MIIT_TOTAL, 0, 0, ( MIIT_NET_PERSONAL + MIIT_NET_FAMILY + MIIT_NET_ENTERPRISE ) / MIIT_TOTAL )*100 ) , 2 ),'fm99999999990.00')||'%' MIIT_NET_RAT,
	to_char(round( ( decode( MIIT_TOTAL, 0, 0, ( MIIT_XA ) / MIIT_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' MIIT_XA_RAT,
	
	ONEZ_TOTAL,
	ONEZ_MARKET_PERSONAL,
	ONEZ_MARKET_FAMILY,
	ONEZ_MARKET_ENTERPRISE,
	ONEZ_NET_PERSONAL,
	ONEZ_NET_FAMILY,
	ONEZ_NET_ENTERPRISE,
	ONEZ_XA,
	to_char(round( ( decode( ONEZ_TOTAL, 0, 0, ( ONEZ_MARKET_PERSONAL + ONEZ_MARKET_FAMILY + ONEZ_MARKET_ENTERPRISE ) / ONEZ_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' ONEZ_MARKET_RAT,
	to_char(round( ( decode( ONEZ_TOTAL, 0, 0, ( ONEZ_NET_PERSONAL + ONEZ_NET_FAMILY + ONEZ_NET_ENTERPRISE ) / ONEZ_TOTAL )*100 ) , 2 ),'fm99999999990.00')||'%' ONEZ_NET_RAT,
	to_char(round( ( decode( ONEZ_TOTAL, 0, 0, ( ONEZ_XA ) / ONEZ_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' ONEZ_XA_RAT,
	
	PHNET_TOTAL,
	PHNET_MARKET_PERSONAL,
	PHNET_MARKET_FAMILY,
	PHNET_MARKET_ENTERPRISE,
	PHNET_NET_PERSONAL,
	PHNET_NET_FAMILY,
	PHNET_NET_ENTERPRISE,
	PHNET_XA,
	to_char(round( ( decode( PHNET_TOTAL, 0, 0, ( PHNET_MARKET_PERSONAL + PHNET_MARKET_FAMILY + PHNET_MARKET_ENTERPRISE ) / PHNET_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' PHNET_MARKET_RAT,
	to_char(round( ( decode( PHNET_TOTAL, 0, 0, ( PHNET_NET_PERSONAL + PHNET_NET_FAMILY + PHNET_NET_ENTERPRISE ) / PHNET_TOTAL )*100 ) , 2 ),'fm99999999990.00')||'%' PHNET_NET_RAT,
	to_char(round( ( decode( PHNET_TOTAL, 0, 0, ( PHNET_XA ) / PHNET_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' PHNET_XA_RAT,
	
	CUSTOME_TOTAL,
	CUSTOME_MARKET_PERSONAL,
	CUSTOME_MARKET_FAMILY,
	CUSTOME_MARKET_ENTERPRISE,
	CUSTOME_NET_PERSONAL,
	CUSTOME_NET_FAMILY,
	CUSTOME_NET_ENTERPRISE,
	CUSTOME_XA,
	to_char(round( ( decode( CUSTOME_TOTAL, 0, 0, ( CUSTOME_MARKET_PERSONAL + CUSTOME_MARKET_FAMILY + CUSTOME_MARKET_ENTERPRISE ) / CUSTOME_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' CUSTOME_MARKET_RAT,
	to_char(round( ( decode( CUSTOME_TOTAL, 0, 0, ( CUSTOME_NET_PERSONAL + CUSTOME_NET_FAMILY + CUSTOME_NET_ENTERPRISE ) / CUSTOME_TOTAL )*100 ) , 2 ),'fm99999999990.00')||'%' CUSTOME_NET_RAT,
	to_char(round( ( decode( CUSTOME_TOTAL, 0, 0, ( CUSTOME_XA ) / CUSTOME_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' CUSTOME_XA_RAT,
	
	THREEO_TOTAL,
	THREEO_MARKET_PERSONAL,
	THREEO_MARKET_FAMILY,
	THREEO_MARKET_ENTERPRISE,
	THREEO_NET_PERSONAL,
	THREEO_NET_FAMILY,
	THREEO_NET_ENTERPRISE,
	THREEO_XA,
	to_char(round( ( decode( THREEO_TOTAL, 0, 0, ( THREEO_MARKET_PERSONAL + THREEO_MARKET_FAMILY + THREEO_MARKET_ENTERPRISE ) / THREEO_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' THREEO_MARKET_RAT,
	to_char(round( ( decode( THREEO_TOTAL, 0, 0, ( THREEO_NET_PERSONAL + THREEO_NET_FAMILY + THREEO_NET_ENTERPRISE ) / THREEO_TOTAL )*100 ) , 2 ),'fm99999999990.00')||'%' THREEO_NET_RAT,
	to_char(round( ( decode( THREEO_TOTAL, 0, 0, ( THREEO_XA ) / THREEO_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' THREEO_XA_RAT,
	
	HEADQ_TOTAL,
	HEADQ_MARKET_PERSONAL,
	HEADQ_MARKET_FAMILY,
	HEADQ_MARKET_ENTERPRISE,
	HEADQ_NET_PERSONAL,
	HEADQ_NET_FAMILY,
	HEADQ_NET_ENTERPRISE,
	HEADQ_XA,
	to_char(round( ( decode( HEADQ_TOTAL, 0, 0, ( HEADQ_MARKET_PERSONAL + HEADQ_MARKET_FAMILY + HEADQ_MARKET_ENTERPRISE ) / HEADQ_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' HEADQ_MARKET_RAT,
	to_char(round( ( decode( HEADQ_TOTAL, 0, 0, ( HEADQ_NET_PERSONAL + HEADQ_NET_FAMILY + HEADQ_NET_ENTERPRISE ) / HEADQ_TOTAL )*100 ) , 2 ),'fm99999999990.00')||'%' HEADQ_NET_RAT,
	to_char(round( ( decode( HEADQ_TOTAL, 0, 0, ( HEADQ_XA ) / HEADQ_TOTAL ) *100), 2 ),'fm99999999990.00')||'%' HEADQ_XA_RAT,
	
	ONET_TOTAL,
	ONET_MARKET_PERSONAL,
	ONET_MARKET_FAMILY,
	ONET_MARKET_ENTERPRISE,
	ONET_NET_PERSONAL,
	ONET_NET_FAMILY,
	ONET_NET_ENTERPRISE,
	ONET_XA,
	to_char(round( ( decode( ONET_TOTAL, 0, 0, ( ONET_MARKET_PERSONAL + ONET_MARKET_FAMILY + ONET_MARKET_ENTERPRISE ) / ONET_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' ONET_MARKET_RAT,
	to_char(round( ( decode( ONET_TOTAL, 0, 0, ( ONET_NET_PERSONAL + ONET_NET_FAMILY + ONET_NET_ENTERPRISE ) / ONET_TOTAL )*100 ) , 2 ),'fm99999999990.00')||'%' ONET_NET_RAT,
	to_char(round( ( decode( ONET_TOTAL, 0, 0, ( ONET_XA ) / ONET_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' ONET_XA_RAT,
	
	RESTORE_TOTAL,
	RESTORE_MARKET_PERSONAL,
	RESTORE_MARKET_FAMILY,
	RESTORE_MARKET_ENTERPRISE,
	RESTORE_NET_PERSONAL,
	RESTORE_NET_FAMILY,
	RESTORE_NET_ENTERPRISE,
	RESTORE_XA ,
	to_char(round( ( decode( RESTORE_TOTAL, 0, 0, ( RESTORE_MARKET_PERSONAL + RESTORE_MARKET_FAMILY + RESTORE_MARKET_ENTERPRISE ) / RESTORE_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' RESTORE_MARKET_RAT,
	to_char(round( ( decode( RESTORE_TOTAL, 0, 0, ( RESTORE_NET_PERSONAL + RESTORE_NET_FAMILY + RESTORE_NET_ENTERPRISE ) / RESTORE_TOTAL )*100 ) , 2 ),'fm99999999990.00')||'%' RESTORE_NET_RAT,
	to_char(round( ( decode( RESTORE_TOTAL, 0, 0, ( RESTORE_XA ) / RESTORE_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' RESTORE_XA_RAT
FROM
	(
	SELECT
		AREA_NAME,
		ACPT_TIME,
		SUM( SJTOTAL_TOTAL ) SJTOTAL_TOTAL,
		SUM( SJTOTAL_MARKET_PERSONAL ) SJTOTAL_MARKET_PERSONAL,
		SUM( SJTOTAL_MARKET_FAMILY ) SJTOTAL_MARKET_FAMILY,
		SUM( SJTOTAL_MARKET_ENTERPRISE ) SJTOTAL_MARKET_ENTERPRISE,
		SUM( SJTOTAL_NET_PERSONAL ) SJTOTAL_NET_PERSONAL,
		SUM( SJTOTAL_NET_FAMILY ) SJTOTAL_NET_FAMILY,
		SUM( SJTOTAL_NET_ENTERPRISE ) SJTOTAL_NET_ENTERPRISE,
		SUM( SJTOTAL_XA ) SJTOTAL_XA,
		SUM( NINE_TOTAL ) NINE_TOTAL,
		SUM( NINE_MARKET_PERSONAL ) NINE_MARKET_PERSONAL,
		SUM( NINE_MARKET_FAMILY ) NINE_MARKET_FAMILY,
		SUM( NINE_MARKET_ENTERPRISE ) NINE_MARKET_ENTERPRISE,
		SUM( NINE_NET_PERSONAL ) NINE_NET_PERSONAL,
		SUM( NINE_NET_FAMILY ) NINE_NET_FAMILY,
		SUM( NINE_NET_ENTERPRISE ) NINE_NET_ENTERPRISE,
		SUM( NINE_XA ) NINE_XA,
		SUM( MIIT_TOTAL ) MIIT_TOTAL,
		SUM( MIIT_MARKET_PERSONAL ) MIIT_MARKET_PERSONAL,
		SUM( MIIT_MARKET_FAMILY ) MIIT_MARKET_FAMILY,
		SUM( MIIT_MARKET_ENTERPRISE ) MIIT_MARKET_ENTERPRISE,
		SUM( MIIT_NET_PERSONAL ) MIIT_NET_PERSONAL,
		SUM( MIIT_NET_FAMILY ) MIIT_NET_FAMILY,
		SUM( MIIT_NET_ENTERPRISE ) MIIT_NET_ENTERPRISE,
		SUM( MIIT_XA ) MIIT_XA,
		SUM( ONEZ_TOTAL ) ONEZ_TOTAL,
		SUM( ONEZ_MARKET_PERSONAL ) ONEZ_MARKET_PERSONAL,
		SUM( ONEZ_MARKET_FAMILY ) ONEZ_MARKET_FAMILY,
		SUM( ONEZ_MARKET_ENTERPRISE ) ONEZ_MARKET_ENTERPRISE,
		SUM( ONEZ_NET_PERSONAL ) ONEZ_NET_PERSONAL,
		SUM( ONEZ_NET_FAMILY ) ONEZ_NET_FAMILY,
		SUM( ONEZ_NET_ENTERPRISE ) ONEZ_NET_ENTERPRISE,
		SUM( ONEZ_XA ) ONEZ_XA,
		SUM( PHNET_TOTAL ) PHNET_TOTAL,
		SUM( PHNET_MARKET_PERSONAL ) PHNET_MARKET_PERSONAL,
		SUM( PHNET_MARKET_FAMILY ) PHNET_MARKET_FAMILY,
		SUM( PHNET_MARKET_ENTERPRISE ) PHNET_MARKET_ENTERPRISE,
		SUM( PHNET_NET_PERSONAL ) PHNET_NET_PERSONAL,
		SUM( PHNET_NET_FAMILY ) PHNET_NET_FAMILY,
		SUM( PHNET_NET_ENTERPRISE ) PHNET_NET_ENTERPRISE,
		SUM( PHNET_XA ) PHNET_XA,
		SUM( CUSTOME_TOTAL ) CUSTOME_TOTAL,
		SUM( CUSTOME_MARKET_PERSONAL ) CUSTOME_MARKET_PERSONAL,
		SUM( CUSTOME_MARKET_FAMILY ) CUSTOME_MARKET_FAMILY,
		SUM( CUSTOME_MARKET_ENTERPRISE ) CUSTOME_MARKET_ENTERPRISE,
		SUM( CUSTOME_NET_PERSONAL ) CUSTOME_NET_PERSONAL,
		SUM( CUSTOME_NET_FAMILY ) CUSTOME_NET_FAMILY,
		SUM( CUSTOME_NET_ENTERPRISE ) CUSTOME_NET_ENTERPRISE,
		SUM( CUSTOME_XA ) CUSTOME_XA,
		SUM( THREEO_TOTAL ) THREEO_TOTAL,
		SUM( THREEO_MARKET_PERSONAL ) THREEO_MARKET_PERSONAL,
		SUM( THREEO_MARKET_FAMILY ) THREEO_MARKET_FAMILY,
		SUM( THREEO_MARKET_ENTERPRISE ) THREEO_MARKET_ENTERPRISE,
		SUM( THREEO_NET_PERSONAL ) THREEO_NET_PERSONAL,
		SUM( THREEO_NET_FAMILY ) THREEO_NET_FAMILY,
		SUM( THREEO_NET_ENTERPRISE ) THREEO_NET_ENTERPRISE,
		SUM( THREEO_XA ) THREEO_XA,
		SUM( HEADQ_TOTAL ) HEADQ_TOTAL,
		SUM( HEADQ_MARKET_PERSONAL ) HEADQ_MARKET_PERSONAL,
		SUM( HEADQ_MARKET_FAMILY ) HEADQ_MARKET_FAMILY,
		SUM( HEADQ_MARKET_ENTERPRISE ) HEADQ_MARKET_ENTERPRISE,
		SUM( HEADQ_NET_PERSONAL ) HEADQ_NET_PERSONAL,
		SUM( HEADQ_NET_FAMILY ) HEADQ_NET_FAMILY,
		SUM( HEADQ_NET_ENTERPRISE ) HEADQ_NET_ENTERPRISE,
		SUM( HEADQ_XA ) HEADQ_XA,
		SUM( ONET_TOTAL ) ONET_TOTAL,
		SUM( ONET_MARKET_PERSONAL ) ONET_MARKET_PERSONAL,
		SUM( ONET_MARKET_FAMILY ) ONET_MARKET_FAMILY,
		SUM( ONET_MARKET_ENTERPRISE ) ONET_MARKET_ENTERPRISE,
		SUM( ONET_NET_PERSONAL ) ONET_NET_PERSONAL,
		SUM( ONET_NET_FAMILY ) ONET_NET_FAMILY,
		SUM( ONET_NET_ENTERPRISE ) ONET_NET_ENTERPRISE,
		SUM( ONET_XA ) ONET_XA,
		SUM( RESTORE_TOTAL ) RESTORE_TOTAL,
		SUM( RESTORE_MARKET_PERSONAL ) RESTORE_MARKET_PERSONAL,
		SUM( RESTORE_MARKET_FAMILY ) RESTORE_MARKET_FAMILY,
		SUM( RESTORE_MARKET_ENTERPRISE ) RESTORE_MARKET_ENTERPRISE,
		SUM( RESTORE_NET_PERSONAL ) RESTORE_NET_PERSONAL,
		SUM( RESTORE_NET_FAMILY ) RESTORE_NET_FAMILY,
		SUM( RESTORE_NET_ENTERPRISE ) RESTORE_NET_ENTERPRISE,
		SUM( RESTORE_XA ) RESTORE_XA 
	FROM
		(
		(SELECT
			to_char( to_date( ACPT_TIME, 'yyyy-mm-dd' ), 'yyyy-mm' ) AS ACPT_TIME,
			(CASE WHEN AREA_NAME='全省' or AREA_NAME='其他' or AREA_NAME='异地' THEN '其他' ELSE AREA_NAME END ) as AREA_NAME,
			SJTOTAL_TOTAL,
			SJTOTAL_MARKET_PERSONAL,
			SJTOTAL_MARKET_FAMILY,
			SJTOTAL_MARKET_ENTERPRISE,
			SJTOTAL_NET_PERSONAL,
			SJTOTAL_NET_FAMILY,
			SJTOTAL_NET_ENTERPRISE,
			SJTOTAL_XA,
			NINE_TOTAL,
			NINE_MARKET_PERSONAL,
			NINE_MARKET_FAMILY,
			NINE_MARKET_ENTERPRISE,
			NINE_NET_PERSONAL,
			NINE_NET_FAMILY,
			NINE_NET_ENTERPRISE,
			NINE_XA,
			MIIT_TOTAL,
			MIIT_MARKET_PERSONAL,
			MIIT_MARKET_FAMILY,
			MIIT_MARKET_ENTERPRISE,
			MIIT_NET_PERSONAL,
			MIIT_NET_FAMILY,
			MIIT_NET_ENTERPRISE,
			MIIT_XA,
			ONEZ_TOTAL,
			ONEZ_MARKET_PERSONAL,
			ONEZ_MARKET_FAMILY,
			ONEZ_MARKET_ENTERPRISE,
			ONEZ_NET_PERSONAL,
			ONEZ_NET_FAMILY,
			ONEZ_NET_ENTERPRISE,
			ONEZ_XA,
			PHNET_TOTAL,
			PHNET_MARKET_PERSONAL,
			PHNET_MARKET_FAMILY,
			PHNET_MARKET_ENTERPRISE,
			PHNET_NET_PERSONAL,
			PHNET_NET_FAMILY,
			PHNET_NET_ENTERPRISE,
			PHNET_XA,
			CUSTOME_TOTAL,
			CUSTOME_MARKET_PERSONAL,
			CUSTOME_MARKET_FAMILY,
			CUSTOME_MARKET_ENTERPRISE,
			CUSTOME_NET_PERSONAL,
			CUSTOME_NET_FAMILY,
			CUSTOME_NET_ENTERPRISE,
			CUSTOME_XA,
			THREEO_TOTAL,
			THREEO_MARKET_PERSONAL,
			THREEO_MARKET_FAMILY,
			THREEO_MARKET_ENTERPRISE,
			THREEO_NET_PERSONAL,
			THREEO_NET_FAMILY,
			THREEO_NET_ENTERPRISE,
			THREEO_XA,
			HEADQ_TOTAL,
			HEADQ_MARKET_PERSONAL,
			HEADQ_MARKET_FAMILY,
			HEADQ_MARKET_ENTERPRISE,
			HEADQ_NET_PERSONAL,
			HEADQ_NET_FAMILY,
			HEADQ_NET_ENTERPRISE,
			HEADQ_XA,
			ONET_TOTAL,
			ONET_MARKET_PERSONAL,
			ONET_MARKET_FAMILY,
			ONET_MARKET_ENTERPRISE,
			ONET_NET_PERSONAL,
			ONET_NET_FAMILY,
			ONET_NET_ENTERPRISE,
			ONET_XA,
			RESTORE_TOTAL,
			RESTORE_MARKET_PERSONAL,
			RESTORE_MARKET_FAMILY,
			RESTORE_MARKET_ENTERPRISE,
			RESTORE_NET_PERSONAL,
			RESTORE_NET_FAMILY,
			RESTORE_NET_ENTERPRISE,
			RESTORE_XA 
		FROM
			NGCS_WF_CMPLNTS_TS_SJA 
		WHERE
			1=1 $customwhere$ )
			
			UNION ALL (
				SELECT to_char( to_date( ACPT_TIME, 'yyyy-mm-dd' ), 'yyyy-mm' ) AS ACPT_TIME,
			'合计' as AREA_NAME, SJTOTAL_TOTAL, SJTOTAL_MARKET_PERSONAL, SJTOTAL_MARKET_FAMILY, SJTOTAL_MARKET_ENTERPRISE,
			SJTOTAL_NET_PERSONAL, SJTOTAL_NET_FAMILY, SJTOTAL_NET_ENTERPRISE, SJTOTAL_XA,
			NINE_TOTAL, NINE_MARKET_PERSONAL, NINE_MARKET_FAMILY, NINE_MARKET_ENTERPRISE, NINE_NET_PERSONAL, NINE_NET_FAMILY, NINE_NET_ENTERPRISE, NINE_XA,
			MIIT_TOTAL, MIIT_MARKET_PERSONAL, MIIT_MARKET_FAMILY, MIIT_MARKET_ENTERPRISE, MIIT_NET_PERSONAL, MIIT_NET_FAMILY, MIIT_NET_ENTERPRISE, MIIT_XA,
			ONEZ_TOTAL, ONEZ_MARKET_PERSONAL, ONEZ_MARKET_FAMILY, ONEZ_MARKET_ENTERPRISE, ONEZ_NET_PERSONAL, ONEZ_NET_FAMILY, ONEZ_NET_ENTERPRISE, ONEZ_XA,
			PHNET_TOTAL, PHNET_MARKET_PERSONAL, PHNET_MARKET_FAMILY, PHNET_MARKET_ENTERPRISE, PHNET_NET_PERSONAL, PHNET_NET_FAMILY, PHNET_NET_ENTERPRISE, PHNET_XA,
			CUSTOME_TOTAL, CUSTOME_MARKET_PERSONAL, CUSTOME_MARKET_FAMILY, CUSTOME_MARKET_ENTERPRISE, CUSTOME_NET_PERSONAL, CUSTOME_NET_FAMILY, CUSTOME_NET_ENTERPRISE, CUSTOME_XA,
			THREEO_TOTAL, THREEO_MARKET_PERSONAL, THREEO_MARKET_FAMILY, THREEO_MARKET_ENTERPRISE, THREEO_NET_PERSONAL, THREEO_NET_FAMILY, THREEO_NET_ENTERPRISE, THREEO_XA,
			HEADQ_TOTAL, HEADQ_MARKET_PERSONAL, HEADQ_MARKET_FAMILY, HEADQ_MARKET_ENTERPRISE, HEADQ_NET_PERSONAL, HEADQ_NET_FAMILY, HEADQ_NET_ENTERPRISE, HEADQ_XA,
			ONET_TOTAL, ONET_MARKET_PERSONAL, ONET_MARKET_FAMILY, ONET_MARKET_ENTERPRISE, ONET_NET_PERSONAL, ONET_NET_FAMILY, ONET_NET_ENTERPRISE, ONET_XA,
			RESTORE_TOTAL, RESTORE_MARKET_PERSONAL, RESTORE_MARKET_FAMILY, RESTORE_MARKET_ENTERPRISE, RESTORE_NET_PERSONAL, RESTORE_NET_FAMILY, RESTORE_NET_ENTERPRISE, RESTORE_XA 
		FROM NGCS_WF_CMPLNTS_TS_SJA  WHERE 1=1 $customwhere$ )
			
		) 
	GROUP BY
		AREA_NAME,
		ACPT_TIME 
	) ) A  LEFT JOIN BS_T_SM_DICITEM ON A.AREA_NAME = BS_T_SM_DICITEM.DINAME||'市'
		WHERE BS_T_SM_DICITEM.DTID = '40288fca3cf76fda013cf779856b0002'  OR AREA_NAME LIKE '%其他%' OR AREA_NAME LIKE '%合计%' ORDER BY ORDERNUM ASC
              ]]>
		</select>
		<!-- <condition cols="3" labprecent="10" textprecent="18">
			<date displayname="时间" name="time" class='Wdate' dateFmt='yyyy-MM'
				defaultvalue="#time#" />
		</condition> -->
		<customwhere name="customwhere" prepend="and">
			<field prepend='and' operator='like' colname='ACPT_TIME' value='#time#' />
		</customwhere>
	</sqlquery>


	<!-- CHBN-升级-月 -->
	<sqlquery name="SQL_TS_TS_CHBN.query">

		<select>
            <![CDATA[
	
	SELECT /*COUNT*/ * /*COUNT*/ FROM ( SELECT CHBN,CHBNNUM,BROAD_TOTAL,BROAD_MARKET,
to_char(round( ( decode( BROAD_TOTAL, 0, 0, BROAD_MARKET / BROAD_TOTAL )*100 ), 2 ) ,'fm99999999990.00')||'%' BROAD_MARKET_RAT,
BROAD_NET,
to_char(round( ( decode( BROAD_TOTAL, 0, 0, BROAD_NET / BROAD_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' BROAD_NET_RAT,
BROAD_XA,
to_char(round( ( decode( BROAD_TOTAL, 0, 0, BROAD_XA / BROAD_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' BROAD_XA_RAT,
ONLINE_TOTAL,ONLINE_MARKET,
to_char(round( ( decode( ONLINE_TOTAL, 0, 0, ONLINE_MARKET / ONLINE_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' ONLINE_MARKET_RAT,
ONLINE_NET,
to_char(round( ( decode( ONLINE_TOTAL, 0, 0, ONLINE_NET / ONLINE_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' ONLINE_NET_RAT,
ONLINE_XA ,
to_char(round( ( decode( ONLINE_TOTAL, 0, 0, ONLINE_XA / ONLINE_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' ONLINE_XA_RAT,
NARROW_TOTAL ,NARROW_SJ,
to_char(round( ( decode( NARROW_TOTAL, 0, 0, NARROW_SJ / NARROW_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' NARROW_SJ_RAT,
NARROW_MARKET,
to_char(round( ( decode( NARROW_TOTAL, 0, 0, NARROW_MARKET / NARROW_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' NARROW_MARKET_RAT,
NARROW_MARKET_SJ,
NARROW_NET,
to_char(round( ( decode( NARROW_TOTAL, 0, 0, NARROW_NET / NARROW_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' NARROW_NET_RAT,
NARROW_NET_SJ,
NARROW_XA,
to_char(round( ( decode( NARROW_TOTAL, 0, 0, NARROW_XA / NARROW_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' NARROW_XA_RAT,
NARROW_XA_SJ FROM (

(SELECT 
* FROM (
SELECT CHBN, CASE WHEN CHBN = 'C' THEN 1 WHEN CHBN = 'H'  THEN 2 WHEN CHBN = 'B'  THEN 3 WHEN CHBN = 'N'  THEN 4	ELSE 5 END AS CHBNNUM, SUM(BROAD_TOTAL) AS BROAD_TOTAL,SUM(BROAD_MARKET) AS BROAD_MARKET,
SUM(BROAD_NET) AS BROAD_NET,SUM(BROAD_XA) AS BROAD_XA,
SUM(ONLINE_TOTAL) AS ONLINE_TOTAL,SUM(ONLINE_MARKET) AS ONLINE_MARKET,
SUM(ONLINE_NET) AS ONLINE_NET ,SUM(ONLINE_XA) AS ONLINE_XA ,
SUM(NARROW_TOTAL) AS NARROW_TOTAL ,SUM(NARROW_SJ) AS NARROW_SJ,
SUM(NARROW_MARKET) AS NARROW_MARKET,SUM(NARROW_MARKET_SJ) AS NARROW_MARKET_SJ,
SUM(NARROW_NET) AS NARROW_NET,SUM(NARROW_NET_SJ) AS NARROW_NET_SJ,
SUM(NARROW_XA) AS NARROW_XA,SUM(NARROW_XA_SJ) AS NARROW_XA_SJ
FROM NGCS_WF_CMPLNTS_TS_CHBN  WHERE 1=1 $customwhere$ GROUP BY CHBN ) )
UNION ALL
( SELECT 
'合计' AS CHBN , 6 AS CHBNNUM ,SUM(BROAD_TOTAL) AS BROAD_TOTAL,SUM(BROAD_MARKET) AS BROAD_MARKET,
SUM(BROAD_NET) AS BROAD_NET,SUM(BROAD_XA) AS BROAD_XA,
SUM(ONLINE_TOTAL) AS ONLINE_TOTAL,SUM(ONLINE_MARKET) AS ONLINE_MARKET,
SUM(ONLINE_NET) AS ONLINE_NET ,SUM(ONLINE_XA) AS ONLINE_XA ,
SUM(NARROW_TOTAL) AS NARROW_TOTAL ,SUM(NARROW_SJ) AS NARROW_SJ,
SUM(NARROW_MARKET) AS NARROW_MARKET,SUM(NARROW_MARKET_SJ) AS NARROW_MARKET_SJ,
SUM(NARROW_NET) AS NARROW_NET,SUM(NARROW_NET_SJ) AS NARROW_NET_SJ,
SUM(NARROW_XA) AS NARROW_XA,SUM(NARROW_XA_SJ) AS NARROW_XA_SJ  FROM NGCS_WF_CMPLNTS_TS_CHBN  WHERE 1=1  $customwhere$ ) ) )
ORDER BY /*ORDERBY*/ CHBNNUM ASC /*ORDERBY*/ 
              ]]>
		</select>
		<customwhere name="customwhere" prepend="and">
			<field prepend='and' operator='like' colname='ACPT_TIME' value='#time#' />
		</customwhere>
	</sqlquery>
	
	
	
	<!-- CHBN-升级-月 -->
	<sqlquery name="SQL_TS_TS_CHBN_IN.query">

		<select>
            <![CDATA[
	
	SELECT /*COUNT*/ * /*COUNT*/ FROM (
SELECT
	CHBN,CHBNNUM,
	TOTAL_TOTAL,
	TOTAL_MARKET,
	to_char(round( ( decode( TOTAL_TOTAL, 0, 0, TOTAL_MARKET / TOTAL_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' TOTAL_MARKET_RAT,
	TOTAL_NET,
	to_char(round( ( decode( TOTAL_TOTAL, 0, 0, TOTAL_NET / TOTAL_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' TOTAL_NET_RAT,
	TOTAL_XA,
	to_char(round( ( decode( TOTAL_TOTAL, 0, 0, TOTAL_XA / TOTAL_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' TOTAL_XA_RAT,
	
	ANSWER_TOTAL,
	ANSWER_MARKET,
	to_char(round( ( decode( ANSWER_TOTAL, 0, 0, ANSWER_MARKET / ANSWER_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' ANSWER_MARKET_RAT,
	ANSWER_NET,
	to_char(round( ( decode( ANSWER_TOTAL, 0, 0, ANSWER_NET / ANSWER_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' ANSWER_NET_RAT,
	ANSWER_XA,
	to_char(round( ( decode( ANSWER_TOTAL, 0, 0, ANSWER_XA / ANSWER_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' ANSWER_XA_RAT,
	
	NEED_FIRST_TOTAL,
	NEED_FIRST_TRE,
	to_char(round( ( decode( NEED_FIRST_TOTAL, 0, 0, NEED_FIRST_TRE / NEED_FIRST_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' NEED_FIRST_TRE_RAT,
	NEED_FIRST_MARKET,
	to_char(round( ( decode( NEED_FIRST_TOTAL, 0, 0, NEED_FIRST_MARKET / NEED_FIRST_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' NEED_FIRST_MARKET_RAT,
	NEED_FIRST_MARKET_TRE,
	NEED_FIRST_NET,
	to_char(round( ( decode( NEED_FIRST_TOTAL, 0, 0, NEED_FIRST_NET / NEED_FIRST_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' NEED_FIRST_NET_RAT,
	NEED_FIRST_NET_TRE,
	NEED_FIRST_GOVER,
	to_char(round( ( decode( NEED_FIRST_TOTAL, 0, 0, NEED_FIRST_GOVER / NEED_FIRST_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' NEED_FIRST_GOVER_RAT,
	NEED_FIRST_GOVER_TRE,
	
	NEED_SECOND_TOTAL,
	NEED_SECOND_MARKET,
	to_char(round( ( decode( NEED_SECOND_TOTAL, 0, 0, NEED_SECOND_MARKET / NEED_SECOND_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' NEED_SECOND_MARKET_RAT,
	NEED_SECOND_NET,
	to_char(round( ( decode( NEED_SECOND_TOTAL, 0, 0, NEED_SECOND_NET / NEED_SECOND_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' NEED_SECOND_NET_RAT,
	NEED_SECOND_XA,
	to_char(round( ( decode( NEED_SECOND_TOTAL, 0, 0, NEED_SECOND_XA / NEED_SECOND_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' NEED_SECOND_XA_RAT,
	
	ASSIST_FIRST_TOTAL,
	ASSIST_FIRST_MARKET,
	to_char(round( ( decode( ASSIST_FIRST_TOTAL, 0, 0, ASSIST_FIRST_MARKET / ASSIST_FIRST_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' ASSIST_FIRST_MARKET_RAT,
	ASSIST_FIRST_NET,
	to_char(round( ( decode( ASSIST_FIRST_TOTAL, 0, 0, ASSIST_FIRST_NET / ASSIST_FIRST_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' ASSIST_FIRST_NET_RAT,
	ASSIST_FIRST_XA,
	to_char(round( ( decode( ASSIST_FIRST_TOTAL, 0, 0, ASSIST_FIRST_XA / ASSIST_FIRST_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%'ASSIST_FIRST_XA_RAT,
	
	ASSIST_SECOND_TOTAL
	
FROM
	((
	SELECT
		CHBN,
	CASE
			WHEN CHBN = 'C' THEN
			1 
			WHEN CHBN = 'H' THEN
			2 
			WHEN CHBN = 'B' THEN
			3 
			WHEN CHBN = 'N' THEN
			4 ELSE 5 
		END AS CHBNNUM,
		SUM( ANSWER_TOTAL+NEED_FIRST_TOTAL+NEED_SECOND_TOTAL+ASSIST_FIRST_TOTAL+ASSIST_SECOND_TOTAL ) AS TOTAL_TOTAL,
		SUM( ANSWER_MARKET+NEED_FIRST_MARKET+NEED_SECOND_MARKET+ASSIST_FIRST_MARKET ) AS TOTAL_MARKET,
		SUM( ANSWER_NET+NEED_FIRST_NET+NEED_SECOND_NET+ASSIST_FIRST_NET ) AS TOTAL_NET,
		SUM( ANSWER_XA+NEED_FIRST_GOVER+NEED_SECOND_XA+ASSIST_FIRST_XA ) AS TOTAL_XA,	
		SUM( ANSWER_TOTAL ) AS ANSWER_TOTAL,
		SUM( ANSWER_MARKET ) AS ANSWER_MARKET,
		SUM( ANSWER_NET ) AS ANSWER_NET,
		SUM( ANSWER_XA ) AS ANSWER_XA,
		SUM( NEED_FIRST_TOTAL ) AS NEED_FIRST_TOTAL,
		SUM( NEED_FIRST_TRE ) AS NEED_FIRST_TRE,
		SUM( NEED_FIRST_MARKET ) AS NEED_FIRST_MARKET,
		SUM( NEED_FIRST_MARKET_TRE ) AS NEED_FIRST_MARKET_TRE,
		SUM( NEED_FIRST_NET ) AS NEED_FIRST_NET,
		SUM( NEED_FIRST_NET_TRE ) AS NEED_FIRST_NET_TRE,
		SUM( NEED_FIRST_GOVER ) AS NEED_FIRST_GOVER,
		SUM( NEED_FIRST_GOVER_TRE ) AS NEED_FIRST_GOVER_TRE,
		SUM( NEED_SECOND_TOTAL ) AS NEED_SECOND_TOTAL,
		SUM( NEED_SECOND_MARKET ) AS NEED_SECOND_MARKET,
		SUM( NEED_SECOND_NET ) AS NEED_SECOND_NET,
		SUM( NEED_SECOND_XA ) AS NEED_SECOND_XA ,
		SUM( ASSIST_FIRST_TOTAL ) AS ASSIST_FIRST_TOTAL,
		SUM( ASSIST_FIRST_MARKET ) AS ASSIST_FIRST_MARKET,
		SUM( ASSIST_FIRST_NET ) AS ASSIST_FIRST_NET,
		SUM( ASSIST_FIRST_XA ) AS ASSIST_FIRST_XA ,
		SUM( ASSIST_SECOND_TOTAL ) AS ASSIST_SECOND_TOTAL
	FROM
		NGCS_WF_CMPLNTS_TS_CHBN_IN 
	WHERE
		1 = 1  $customwhere$
	GROUP BY
	CHBN 
	)
	
	UNION ALL 
	
	
	SELECT 
		'合计' AS CHBN , 6 AS CHBNNUM ,
		SUM( ANSWER_TOTAL+NEED_FIRST_TOTAL+NEED_SECOND_TOTAL+ASSIST_FIRST_TOTAL+ASSIST_SECOND_TOTAL ) AS TOTAL_TOTAL,
		SUM( ANSWER_MARKET+NEED_FIRST_MARKET+NEED_SECOND_MARKET+ASSIST_FIRST_MARKET ) AS TOTAL_MARKET,
		SUM( ANSWER_NET+NEED_FIRST_NET+NEED_SECOND_NET+ASSIST_FIRST_NET ) AS TOTAL_NET,
		SUM( ANSWER_XA+NEED_FIRST_GOVER+NEED_SECOND_XA+ASSIST_FIRST_XA ) AS TOTAL_XA,	
		SUM( ANSWER_TOTAL ) AS ANSWER_TOTAL,
		SUM( ANSWER_MARKET ) AS ANSWER_MARKET,
		SUM( ANSWER_NET ) AS ANSWER_NET,
		SUM( ANSWER_XA ) AS ANSWER_XA,
		SUM( NEED_FIRST_TOTAL ) AS NEED_FIRST_TOTAL,
		SUM( NEED_FIRST_TRE ) AS NEED_FIRST_TRE,
		SUM( NEED_FIRST_MARKET ) AS NEED_FIRST_MARKET,
		SUM( NEED_FIRST_MARKET_TRE ) AS NEED_FIRST_MARKET_TRE,
		SUM( NEED_FIRST_NET ) AS NEED_FIRST_NET,
		SUM( NEED_FIRST_NET_TRE ) AS NEED_FIRST_NET_TRE,
		SUM( NEED_FIRST_GOVER ) AS NEED_FIRST_GOVER,
		SUM( NEED_FIRST_GOVER_TRE ) AS NEED_FIRST_GOVER_TRE,
		SUM( NEED_SECOND_TOTAL ) AS NEED_SECOND_TOTAL,
		SUM( NEED_SECOND_MARKET ) AS NEED_SECOND_MARKET,
		SUM( NEED_SECOND_NET ) AS NEED_SECOND_NET,
		SUM( NEED_SECOND_XA ) AS NEED_SECOND_XA ,
		SUM( ASSIST_FIRST_TOTAL ) AS ASSIST_FIRST_TOTAL,
		SUM( ASSIST_FIRST_MARKET ) AS ASSIST_FIRST_MARKET,
		SUM( ASSIST_FIRST_NET ) AS ASSIST_FIRST_NET,
		SUM( ASSIST_FIRST_XA ) AS ASSIST_FIRST_XA ,
		SUM( ASSIST_SECOND_TOTAL ) AS ASSIST_SECOND_TOTAL
	FROM
		NGCS_WF_CMPLNTS_TS_CHBN_IN 
	WHERE
		1 = 1  $customwhere$
	 ) )
	
ORDER BY /*ORDERBY*/ CHBNNUM ASC /*ORDERBY*/ 
              ]]>
		</select>
		<customwhere name="customwhere" prepend="and">
			<field prepend='and' operator='like' colname='ACPT_TIME' value='#time#' />
		</customwhere>
	</sqlquery>
	


	<!-- 投诉数据总体情况报表-月 -->
	<sqlquery name="SQL_TS_TOTAL_SJA.query">

		<select>
            <![CDATA[
	SELECT /*COUNT*/ A.*  /*COUNT*/ FROM (
SELECT
	ACPT_TIME,
	RESP_ACPT,
	BROAD_MARKET_PERSONAL,
	BROAD_MARKET_FAMILY,
	BROAD_MARKET_ENTERPRISE,
	BROAD_NET_PERSONAL,
	BROAD_NET_FAMILY,
	BROAD_NET_ENTERPRISE,
	BROAD_XA,
	to_char(round( ( decode( valueg, 0, 0, ( BROAD_MARKET_PERSONAL + BROAD_MARKET_FAMILY + BROAD_MARKET_ENTERPRISE ) / valueg )*100 ), 2 ),'FM9999999999999990.00')||'%' valueg1,
	to_char(round( ( decode( valueg, 0, 0, ( BROAD_NET_PERSONAL + BROAD_NET_FAMILY + BROAD_NET_ENTERPRISE ) / valueg )* 100 ), 2 ),'FM9999999999999990.00')||'%' valueg2,
	to_char(round( ( decode( valueg, 0, 0, ( BROAD_XA ) / valueg ) * 100), 2 ),'FM9999999999999990.00')||'%' valueg3,

	ONLINE_MARKET_PERSONAL,
	ONLINE_MARKET_FAMILY,
	ONLINE_MARKET_ENTERPRISE,
	ONLINE_NET_PERSONAL,
	ONLINE_NET_FAMILY,
	ONLINE_NET_ENTERPRISE,
	ONLINE_XA,
	to_char(round( ( decode( valuez, 0, 0, ( ONLINE_MARKET_PERSONAL + ONLINE_MARKET_FAMILY + ONLINE_MARKET_ENTERPRISE ) / valuez ) * 100) , 2 ),'FM9999999999999990.00')||'%' valuez1,
	to_char(round( ( decode( valuez, 0, 0, ( ONLINE_NET_PERSONAL + ONLINE_NET_FAMILY + ONLINE_NET_ENTERPRISE ) / valuez ) * 100) , 2 ),'FM9999999999999990.00')||'%' valuez2,
	to_char(round( ( decode( valuez, 0, 0, ( ONLINE_XA ) / valuez )  * 100), 2 ),'FM9999999999999990.00')||'%' valuez3 ,
	
	NARROW_SJ,
	NARROW_MARKET_PERSONAL,
	NARROW_MARKET_FAMILY,
	NARROW_MARKET_ENTERPRISE,
	NARROW_MARKET_SJ,
	NARROW_NET_PERSONAL,
	NARROW_NET_FAMILY,
	NARROW_NET_ENTERPRISE,
	NARROW_NET_SJ,
	NARROW_XA,
	NARROW_XA_SJ,

		to_char(round( ( decode( valuex, 0, 0, ( NARROW_SJ ) / valuex ) * 100) , 2 ),'FM9999999999999990.00')||'%' valuex1,
		to_char(round( ( decode( valuex, 0, 0, ( NARROW_MARKET_PERSONAL + NARROW_MARKET_FAMILY + NARROW_MARKET_ENTERPRISE ) / valuex ) * 100) , 2 ),'FM9999999999999990.00')||'%' valuex2,
		to_char(round( ( decode( valuex, 0, 0, ( NARROW_NET_PERSONAL + NARROW_NET_FAMILY + NARROW_NET_ENTERPRISE ) / valuex )* 100 ) , 2 ),'FM9999999999999990.00')||'%' valuex3,
		to_char(round( ( decode( valuex, 0, 0, ( NARROW_XA ) / valuex ) * 100) , 2 ),'FM9999999999999990.00')||'%' valuex4 ,
			VALUEG,
			VALUEZ,
			VALUEX

FROM
	(

SELECT
		RESP_ACPT,
		ACPT_TIME,
		SUM( BROAD_MARKET_PERSONAL ) BROAD_MARKET_PERSONAL,
		SUM( BROAD_MARKET_FAMILY ) BROAD_MARKET_FAMILY,
		SUM( BROAD_MARKET_ENTERPRISE ) BROAD_MARKET_ENTERPRISE,
		SUM( BROAD_NET_PERSONAL ) BROAD_NET_PERSONAL,
		SUM( BROAD_NET_FAMILY ) BROAD_NET_FAMILY,
		SUM( BROAD_NET_ENTERPRISE ) BROAD_NET_ENTERPRISE,
		SUM( BROAD_XA ) BROAD_XA,
		SUM( ONLINE_MARKET_PERSONAL ) ONLINE_MARKET_PERSONAL,
		SUM( ONLINE_MARKET_FAMILY ) ONLINE_MARKET_FAMILY,
		SUM( ONLINE_MARKET_ENTERPRISE ) ONLINE_MARKET_ENTERPRISE,
		SUM( ONLINE_NET_PERSONAL ) ONLINE_NET_PERSONAL,
		SUM( ONLINE_NET_FAMILY ) ONLINE_NET_FAMILY,
		SUM( ONLINE_NET_ENTERPRISE ) ONLINE_NET_ENTERPRISE,
		SUM( ONLINE_XA ) ONLINE_XA,
		SUM( NARROW_SJ ) NARROW_SJ,
		SUM( NARROW_MARKET_PERSONAL ) NARROW_MARKET_PERSONAL,
		SUM( NARROW_MARKET_FAMILY ) NARROW_MARKET_FAMILY,
		SUM( NARROW_MARKET_ENTERPRISE ) NARROW_MARKET_ENTERPRISE,
		SUM( NARROW_MARKET_SJ ) NARROW_MARKET_SJ,
		SUM( NARROW_NET_PERSONAL ) NARROW_NET_PERSONAL,
		SUM( NARROW_NET_FAMILY ) NARROW_NET_FAMILY,
		SUM( NARROW_NET_ENTERPRISE ) NARROW_NET_ENTERPRISE,
		SUM( NARROW_NET_SJ ) NARROW_NET_SJ,
		SUM( NARROW_XA ) NARROW_XA,
		SUM( NARROW_XA_SJ ) NARROW_XA_SJ,
		SUM( VALUEG ) VALUEG,
		SUM( VALUEZ ) VALUEZ,
		SUM( VALUEX ) VALUEX
	FROM
		(
			(SELECT
			to_char( to_date( ACPT_TIME, 'yyyy-mm-dd' ), 'yyyy-mm' ) AS ACPT_TIME,
			(CASE WHEN (RESP_ACPT = '全省' OR RESP_ACPT = '异地' OR RESP_ACPT = '其他') THEN '其他' ELSE RESP_ACPT END ) AS RESP_ACPT, 
			BROAD_MARKET_PERSONAL, BROAD_MARKET_FAMILY, BROAD_MARKET_ENTERPRISE, BROAD_NET_PERSONAL, BROAD_NET_FAMILY, BROAD_NET_ENTERPRISE, BROAD_XA, ONLINE_MARKET_PERSONAL, ONLINE_MARKET_FAMILY, ONLINE_MARKET_ENTERPRISE, ONLINE_NET_PERSONAL, ONLINE_NET_FAMILY, ONLINE_NET_ENTERPRISE, ONLINE_XA, NARROW_SJ, NARROW_MARKET_PERSONAL, NARROW_MARKET_FAMILY, NARROW_MARKET_ENTERPRISE, NARROW_MARKET_SJ, NARROW_NET_PERSONAL, NARROW_NET_FAMILY, NARROW_NET_ENTERPRISE, NARROW_NET_SJ, NARROW_XA, NARROW_XA_SJ, SYNCDATE, VALUEG, VALUEZ, VALUEX
		FROM
			NGCS_WF_CMPLNTS_TS_TOTAL 
		WHERE
			1=1  $customwhere$ )
			
			UNION ALL 
			(
				SELECT
			to_char( to_date( ACPT_TIME, 'yyyy-mm-dd' ), 'yyyy-mm' ) AS ACPT_TIME,
			'合计' AS RESP_ACPT, BROAD_MARKET_PERSONAL, BROAD_MARKET_FAMILY, BROAD_MARKET_ENTERPRISE, BROAD_NET_PERSONAL, BROAD_NET_FAMILY, BROAD_NET_ENTERPRISE, BROAD_XA, ONLINE_MARKET_PERSONAL, ONLINE_MARKET_FAMILY, ONLINE_MARKET_ENTERPRISE, ONLINE_NET_PERSONAL, ONLINE_NET_FAMILY, ONLINE_NET_ENTERPRISE, ONLINE_XA, NARROW_SJ, NARROW_MARKET_PERSONAL, NARROW_MARKET_FAMILY, NARROW_MARKET_ENTERPRISE, NARROW_MARKET_SJ, NARROW_NET_PERSONAL, NARROW_NET_FAMILY, NARROW_NET_ENTERPRISE, NARROW_NET_SJ, NARROW_XA, NARROW_XA_SJ, SYNCDATE, VALUEG, VALUEZ, VALUEX
		FROM
			NGCS_WF_CMPLNTS_TS_TOTAL 
		WHERE
			1=1 $customwhere$
			)
			
		)
	GROUP BY
		RESP_ACPT,
		ACPT_TIME 
		) )  A  LEFT JOIN BS_T_SM_DICITEM ON A.RESP_ACPT = BS_T_SM_DICITEM.DINAME||'市'
		WHERE BS_T_SM_DICITEM.DTID = '40288fca3cf76fda013cf779856b0002' OR RESP_ACPT LIKE '%其他%' OR RESP_ACPT LIKE '%合计%' ORDER BY ORDERNUM ASC
              ]]>
		</select>
		<!-- <condition cols="3" labprecent="10" textprecent="18">
			<date displayname="时间" name="time" class='Wdate' dateFmt='yyyy-MM'
				defaultvalue="#time#" />
		</condition> -->
		<customwhere name="customwhere" prepend="and">
			<field prepend='and' operator='like' colname='ACPT_TIME' value='#time#' />
		</customwhere>
	</sqlquery>
	

	
	<!-- 费用质疑投诉总体情况报表 -->
	<sqlquery name="SQL_TS_COST.query">

		<select>
            <![CDATA[
		SELECT
/*COUNT*/A.* /*COUNT*/
	
FROM
	(
	SELECT
		AREA_NAME,
		complaints,
		round( ( decode( TOTAL, 0, 0, ( complaints * 10000 ) / TOTAL ) * 100 ), 2 ) TOTAL,
		complaints_max,
		complaints_min,
		decode( complaints_max, 0, 0, ( ( complaints_max - complaints_min ) / complaints_max * 100 ) ) differ 
	FROM
		(
		SELECT
			AREA_NAME,
			TOTAL,
			sum( complaints ) AS complaints,
			sum( complaints_max ) AS complaints_max,
			sum( complaints_min ) AS complaints_min 
		FROM
			(
			SELECT
				AREA_NAME,
				complaints,
				TOTAL,
				complaints_max,
				complaints_min 
			FROM
				NGCS_WF_CMPLNTS_TS_COST 
			WHERE
				1 = 1 $customwhere$ 
			) 
		GROUP BY
			AREA_NAME,
			TOTAL 
		) 
	) A
	LEFT JOIN BS_T_SM_DICITEM ON A.AREA_NAME = BS_T_SM_DICITEM.DINAME || '市' 
WHERE
	BS_T_SM_DICITEM.DTID = '40288fca3cf76fda013cf779856b0002' 
ORDER BY
	ORDERNUM ASC
              ]]>
		</select>
		<!-- <condition cols="3" labprecent="10" textprecent="18">
			<date displayname="时间" name="time" class='Wdate' dateFmt='yyyy-MM'
				defaultvalue="#time#" />
		</condition> -->
		<customwhere name="customwhere" prepend="and">
			<field prepend='and' operator='like' colname='ACPT_TIME' value='#time#' />
		</customwhere>
	</sqlquery>
	

		<!-- 投诉数据携号转网报表-总量 -->
	<sqlquery name="SQL_TS_TS_MNP.query">

		<select>
            <![CDATA[
	SELECT /*COUNT*/ A.*  /*COUNT*/ FROM ( SELECT 
CASE WHEN AREA_NAME = '全省' THEN '其他' ELSE AREA_NAME END AS AREA_NAME ,
BROAD_TOTAL,
BROAD_MARKET,
BROAD_NET,
BROAD_MARKET_OUT,
BROAD_NET_OUT,
to_char(round( ( decode( BROAD_TOTAL, 0, 0, ( BROAD_MARKET_OUT + BROAD_NET_OUT ) / BROAD_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' BROAD_OUT_RAT,
BROAD_MARKET_IN,
BROAD_NET_IN,
to_char(round( ( decode( BROAD_TOTAL, 0, 0, ( BROAD_MARKET_IN + BROAD_NET_IN ) / BROAD_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' BROAD_IN_RAT,
ONLINE_TOTAL,
ONLINE_MARKET,
ONLINE_NET,
ONLINE_MARKET_OUT,
ONLINE_NET_OUT,
to_char(round( ( decode( ONLINE_TOTAL, 0, 0, ( ONLINE_MARKET_OUT + ONLINE_NET_OUT ) / ONLINE_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' ONLINE_OUT_RAT,
ONLINE_MARKET_IN,
ONLINE_NET_IN,
to_char(round( ( decode( ONLINE_TOTAL, 0, 0, ( ONLINE_MARKET_IN + ONLINE_NET_IN ) / ONLINE_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' ONLINE_IN_RAT,
NARROW_TOTAL,
NARROW_MARKET,
NARROW_NET,
NARROW_SJ,
NARROW_MARKET_SJ,
NARROW_NET_SJ,
NARROW_MARKET_OUT,
NARROW_NET_OUT,
to_char(round( ( decode( NARROW_TOTAL, 0, 0, ( NARROW_MARKET_OUT + NARROW_NET_OUT ) / NARROW_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' NARROW_OUT_RAT,
NARROW_MARKET_OUT_SJ,
NARROW_NET_OUT_SJ,
to_char(round( ( decode( NARROW_SJ, 0, 0, ( NARROW_MARKET_OUT_SJ + NARROW_NET_OUT_SJ ) / NARROW_SJ )*100 ), 2 ),'fm99999999990.00')||'%' NARROW_OUT_SJ_RAT,
NARROW_MARKET_IN,
NARROW_NET_IN,
to_char(round( ( decode( NARROW_TOTAL, 0, 0, ( NARROW_MARKET_IN + NARROW_NET_IN ) / NARROW_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' NARROW_IN_RAT,
NARROW_MARKET_IN_SJ,
NARROW_NET_IN_SJ,
to_char(round( ( decode( NARROW_SJ, 0, 0, ( NARROW_MARKET_IN_SJ + NARROW_NET_IN_SJ ) / NARROW_SJ )*100 ), 2 ),'fm99999999990.00')||'%' NARROW_IN_SJ_RAT
FROM (
(SELECT AREA_NAME ,
SUM(BROAD_TOTAL) BROAD_TOTAL,
SUM(BROAD_MARKET) BROAD_MARKET,
SUM(BROAD_NET) BROAD_NET,
SUM(BROAD_MARKET_OUT) BROAD_MARKET_OUT,
SUM(BROAD_NET_OUT) BROAD_NET_OUT,
SUM(BROAD_MARKET_IN) BROAD_MARKET_IN,
SUM(BROAD_NET_IN) BROAD_NET_IN,
SUM(ONLINE_TOTAL) ONLINE_TOTAL,
SUM(ONLINE_MARKET) ONLINE_MARKET,
SUM(ONLINE_NET) ONLINE_NET,
SUM(ONLINE_MARKET_OUT) ONLINE_MARKET_OUT,
SUM(ONLINE_NET_OUT) ONLINE_NET_OUT,
SUM(ONLINE_MARKET_IN) ONLINE_MARKET_IN,
SUM(ONLINE_NET_IN) ONLINE_NET_IN,
SUM(NARROW_TOTAL) NARROW_TOTAL,
SUM(NARROW_MARKET) NARROW_MARKET,
SUM(NARROW_NET) NARROW_NET,
SUM(NARROW_SJ) NARROW_SJ,
SUM(NARROW_MARKET_SJ) NARROW_MARKET_SJ,
SUM(NARROW_NET_SJ) NARROW_NET_SJ,
SUM(NARROW_MARKET_OUT) NARROW_MARKET_OUT,
SUM(NARROW_NET_OUT) NARROW_NET_OUT,
SUM(NARROW_MARKET_OUT_SJ) NARROW_MARKET_OUT_SJ,
SUM(NARROW_NET_OUT_SJ) NARROW_NET_OUT_SJ,
SUM(NARROW_MARKET_IN) NARROW_MARKET_IN,
SUM(NARROW_NET_IN) NARROW_NET_IN,
SUM(NARROW_MARKET_IN_SJ) NARROW_MARKET_IN_SJ,
SUM(NARROW_NET_IN_SJ) NARROW_NET_IN_SJ
FROM NGCS_WF_CMPLNTS_TS_MNP WHERE 1=1  $customwhere$  GROUP BY AREA_NAME )

UNION ALL 
 (SELECT '合计' AS AREA_NAME ,
SUM(BROAD_TOTAL) BROAD_TOTAL,
SUM(BROAD_MARKET) BROAD_MARKET,
SUM(BROAD_NET) BROAD_NET,
SUM(BROAD_MARKET_OUT) BROAD_MARKET_OUT,
SUM(BROAD_NET_OUT) BROAD_NET_OUT,
SUM(BROAD_MARKET_IN) BROAD_MARKET_IN,
SUM(BROAD_NET_IN) BROAD_NET_IN,
SUM(ONLINE_TOTAL) ONLINE_TOTAL,
SUM(ONLINE_MARKET) ONLINE_MARKET,
SUM(ONLINE_NET) ONLINE_NET,
SUM(ONLINE_MARKET_OUT) ONLINE_MARKET_OUT,
SUM(ONLINE_NET_OUT) ONLINE_NET_OUT,
SUM(ONLINE_MARKET_IN) ONLINE_MARKET_IN,
SUM(ONLINE_NET_IN) ONLINE_NET_IN,
SUM(NARROW_TOTAL) NARROW_TOTAL,
SUM(NARROW_MARKET) NARROW_MARKET,
SUM(NARROW_NET) NARROW_NET,
SUM(NARROW_SJ) NARROW_SJ,
SUM(NARROW_MARKET_SJ) NARROW_MARKET_SJ,
SUM(NARROW_NET_SJ) NARROW_NET_SJ,
SUM(NARROW_MARKET_OUT) NARROW_MARKET_OUT,
SUM(NARROW_NET_OUT) NARROW_NET_OUT,
SUM(NARROW_MARKET_OUT_SJ) NARROW_MARKET_OUT_SJ,
SUM(NARROW_NET_OUT_SJ) NARROW_NET_OUT_SJ,
SUM(NARROW_MARKET_IN) NARROW_MARKET_IN,
SUM(NARROW_NET_IN) NARROW_NET_IN,
SUM(NARROW_MARKET_IN_SJ) NARROW_MARKET_IN_SJ,
SUM(NARROW_NET_IN_SJ) NARROW_NET_IN_SJ
FROM NGCS_WF_CMPLNTS_TS_MNP WHERE 1=1  $customwhere$  ) )

)  A  LEFT JOIN BS_T_SM_DICITEM ON A.AREA_NAME = BS_T_SM_DICITEM.DINAME||'市'
		WHERE BS_T_SM_DICITEM.DTID = '40288fca3cf76fda013cf779856b0002' OR AREA_NAME LIKE '%其他%' OR AREA_NAME LIKE '%合计%'  ORDER BY ORDERNUM ASC
              ]]>
		</select>
		<customwhere name="customwhere" prepend="and">
			<field prepend='and' operator='like' colname='ACPT_TIME' value='#time#' />
		</customwhere>
	</sqlquery>

	
			<!-- 投诉数据携号转网报表-升级 -->
	<sqlquery name="SQL_TS_TS_MNPSJ.query">

		<select>
            <![CDATA[
				SELECT /*COUNT*/ A.*  /*COUNT*/ FROM (  
SELECT AREA_NAME , 

SJTOTAL_TOTAL, 
SJTOTAL_MARKET_TOTAL, 
SJTOTAL_NET_TOTAL, 
SJTOTAL_MARKET_OUT, 
SJTOTAL_NET_OUT, 
to_char(round( ( decode( SJTOTAL_TOTAL, 0, 0, ( SJTOTAL_MARKET_OUT + SJTOTAL_NET_OUT ) / SJTOTAL_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' SJTOTAL_OUT_RAT, 
SJTOTAL_MARKET_IN, 
SJTOTAL_NET_IN, 
to_char(round( ( decode( SJTOTAL_TOTAL, 0, 0, ( SJTOTAL_MARKET_IN + SJTOTAL_NET_IN ) / SJTOTAL_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' SJTOTAL_IN_RAT, 

NINE_TOTAL, 
NINE_MARKET_TOTAL, 
NINE_NET_TOTAL, 
NINE_MARKET_OUT,
NINE_NET_OUT, 
to_char(round( ( decode( NINE_TOTAL, 0, 0, ( NINE_MARKET_OUT + NINE_NET_OUT ) / NINE_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' NINE_OUT_RAT, 
NINE_MARKET_IN, 
NINE_NET_IN,
to_char(round( ( decode( NINE_TOTAL, 0, 0, ( NINE_MARKET_IN + NINE_NET_IN ) / NINE_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' NINE_IN_RAT, 

MIIT_TOTAL, 
MIIT_MARKET_TOTAL, 
MIIT_NET_TOTAL, 
MIIT_MARKET_OUT, 
MIIT_NET_OUT, 
to_char(round( ( decode( MIIT_TOTAL, 0, 0, ( MIIT_MARKET_OUT + MIIT_NET_OUT ) / MIIT_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' MIIT_OUT_RAT, 
MIIT_MARKET_IN, 
MIIT_NET_IN, 
to_char(round( ( decode( MIIT_TOTAL, 0, 0, ( MIIT_MARKET_IN + MIIT_NET_IN ) / MIIT_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' MIIT_IN_RAT, 

ONEZ_TOTAL, 
ONEZ_MARKET_TOTAL, 
ONEZ_NET_TOTAL, 
ONEZ_MARKET_OUT, 
ONEZ_NET_OUT, 
to_char(round( ( decode( ONEZ_TOTAL, 0, 0, ( ONEZ_MARKET_OUT + ONEZ_NET_OUT ) / ONEZ_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' ONEZ_OUT_RAT, 
ONEZ_MARKET_IN, 
ONEZ_NET_IN, 
to_char(round( ( decode( ONEZ_TOTAL, 0, 0, ( ONEZ_MARKET_IN + ONEZ_NET_IN ) / ONEZ_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' ONEZ_IN_RAT, 

ONET_TOTAL, 
ONET_MARKET_TOTAL, 
ONET_NET_TOTAL,
ONET_MARKET_OUT, 
ONET_NET_OUT, 
to_char(round( ( decode( ONET_TOTAL, 0, 0, ( ONET_MARKET_OUT + ONET_NET_OUT ) / ONET_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' ONET_OUT_RAT,
ONET_MARKET_IN, 
ONET_NET_IN, 
to_char(round( ( decode( ONET_TOTAL, 0, 0, ( ONET_MARKET_IN + ONET_NET_IN ) / ONET_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' ONET_IN_RAT, 

OTHERS_TOTAL, 
OTHERS_MARKET_TOTAL, 
OTHERS_NET_TOTAL, 
OTHERS_MARKET_OUT, 
OTHERS_NET_OUT,
to_char(round( ( decode( OTHERS_TOTAL, 0, 0, ( OTHERS_MARKET_OUT + OTHERS_NET_OUT ) / OTHERS_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%'OTHERS_OUT_RAT,
OTHERS_MARKET_IN,
OTHERS_NET_IN ,
to_char(round( ( decode( OTHERS_TOTAL, 0, 0, ( OTHERS_MARKET_IN + OTHERS_NET_IN ) / OTHERS_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' OTHERS_IN_RAT

FROM (
SELECT nvl((CASE WHEN AREA_NAME = '全省' OR AREA_NAME = '异地' OR AREA_NAME = '其他' THEN '其他' ELSE AREA_NAME END),'合计' )  AS AREA_NAME ,

SUM(SJTOTAL_TOTAL) SJTOTAL_TOTAL,
SUM(SJTOTAL_MARKET_TOTAL) SJTOTAL_MARKET_TOTAL,
SUM(SJTOTAL_NET_TOTAL) SJTOTAL_NET_TOTAL,
SUM(SJTOTAL_MARKET_OUT) SJTOTAL_MARKET_OUT,
SUM(SJTOTAL_NET_OUT) SJTOTAL_NET_OUT,
SUM(SJTOTAL_MARKET_IN) SJTOTAL_MARKET_IN,
SUM(SJTOTAL_NET_IN) SJTOTAL_NET_IN,

SUM(NINE_TOTAL) NINE_TOTAL,
SUM(NINE_MARKET_TOTAL) NINE_MARKET_TOTAL,
SUM(NINE_NET_TOTAL) NINE_NET_TOTAL,
SUM(NINE_MARKET_OUT) NINE_MARKET_OUT,
SUM(NINE_NET_OUT) NINE_NET_OUT,
SUM(NINE_MARKET_IN) NINE_MARKET_IN,
SUM(NINE_NET_IN) NINE_NET_IN,

SUM(MIIT_TOTAL) MIIT_TOTAL,
SUM(MIIT_MARKET_TOTAL) MIIT_MARKET_TOTAL,
SUM(MIIT_NET_TOTAL) MIIT_NET_TOTAL,
SUM(MIIT_MARKET_OUT) MIIT_MARKET_OUT,
SUM(MIIT_NET_OUT) MIIT_NET_OUT,
SUM(MIIT_MARKET_IN) MIIT_MARKET_IN,
SUM(MIIT_NET_IN) MIIT_NET_IN,

SUM(ONEZ_TOTAL) ONEZ_TOTAL,
SUM(ONEZ_MARKET_TOTAL) ONEZ_MARKET_TOTAL,
SUM(ONEZ_NET_TOTAL) ONEZ_NET_TOTAL,
SUM(ONEZ_MARKET_OUT) ONEZ_MARKET_OUT,
SUM(ONEZ_NET_OUT) ONEZ_NET_OUT,
SUM(ONEZ_MARKET_IN) ONEZ_MARKET_IN,
SUM(ONEZ_NET_IN) ONEZ_NET_IN,

SUM(ONET_TOTAL) ONET_TOTAL,
SUM(ONET_MARKET_TOTAL) ONET_MARKET_TOTAL,
SUM(ONET_NET_TOTAL) ONET_NET_TOTAL,
SUM(ONET_MARKET_OUT) ONET_MARKET_OUT,
SUM(ONET_NET_OUT) ONET_NET_OUT,
SUM(ONET_MARKET_IN) ONET_MARKET_IN,
SUM(ONET_NET_IN) ONET_NET_IN,

SUM(OTHERS_TOTAL) OTHERS_TOTAL,
SUM(OTHERS_MARKET_TOTAL) OTHERS_MARKET_TOTAL,
SUM(OTHERS_NET_TOTAL) OTHERS_NET_TOTAL,
SUM(OTHERS_MARKET_OUT) OTHERS_MARKET_OUT,
SUM(OTHERS_NET_OUT) OTHERS_NET_OUT,
SUM(OTHERS_MARKET_IN) OTHERS_MARKET_IN,
SUM(OTHERS_NET_IN) OTHERS_NET_IN

FROM NGCS_WF_CMPLNTS_TS_MNP_SJ WHERE 1=1  $customwhere$  GROUP BY rollup((CASE WHEN AREA_NAME = '全省' OR AREA_NAME = '异地' OR AREA_NAME = '其他' THEN '其他' ELSE AREA_NAME END)) )
)  A   order by /*ORDERBY*/ instr('沈阳,大连,鞍山,抚顺,本溪,丹东,锦州,营口,阜新,辽阳,铁岭,朝阳,盘锦,葫芦,其他,合计',substr(area_name,0,2)) /*ORDERBY*/
              ]]>
		</select>
		<customwhere name="customwhere" prepend="and">
			<field prepend='and' operator='like' colname='ACPT_TIME' value='#time#' />
		</customwhere>
	</sqlquery>
	
	
	<!-- 5G投诉总体情况报表-集团-->
	<sqlquery	name="SQL_TS_FG.query">
	<select>
	 <![CDATA[
		SELECT /*COUNT*/ A.* /*COUNT*/ FROM ( SELECT 

		CASE WHEN AREA_NAME = '全省' THEN '其他' ELSE AREA_NAME END AS AREA_NAME,
		BROAD_TOTAL,
		BROAD_MARKET,
		BROAD_NET,
		to_char(round( ( decode( BROAD_TOTAL, 0, 0, BROAD_MARKET / BROAD_TOTAL ) * 100 ), 2 ),'fm99999999990.00') || '%' BROAD_MARKET_RAT,
		to_char(round( ( decode( BROAD_TOTAL, 0, 0, BROAD_NET / BROAD_TOTAL ) * 100 ), 2 ),'fm99999999990.00') || '%' BROAD_NET_RAT,
		ONLINE_TOTAL,
		ONLINE_MARKET,
		ONLINE_NET,
		to_char(round( ( decode( ONLINE_TOTAL, 0, 0, ONLINE_MARKET / ONLINE_TOTAL ) * 100 ), 2 ),'fm99999999990.00') || '%' ONLINE_MARKET_RAT,
		to_char(round( ( decode( ONLINE_TOTAL, 0, 0, ONLINE_NET / ONLINE_TOTAL ) * 100 ), 2 ),'fm99999999990.00') || '%' ONLINE_NET_RAT,
		NARROW_TOTAL,
		NARROW_MARKET,
		NARROW_NET,
		to_char(round( ( decode( NARROW_TOTAL, 0, 0, NARROW_MARKET / NARROW_TOTAL ) * 100 ), 2 ),'fm99999999990.00') || '%' NARROW_MARKET_RAT,
		to_char(round( ( decode( NARROW_TOTAL, 0, 0, NARROW_NET / NARROW_TOTAL ) * 100 ), 2 ),'fm99999999990.00') || '%' NARROW_NET_RAT,
		NARROW_MARKET_SJ,
		NARROW_NET_SJ 
FROM ( (
SELECT

			AREA_NAME,
			SUM( BROAD_TOTAL )  BROAD_TOTAL,
			SUM( BROAD_MARKET ) BROAD_MARKET,
			SUM( BROAD_NET ) BROAD_NET,
			SUM( ONLINE_TOTAL ) ONLINE_TOTAL,
			SUM( ONLINE_MARKET ) ONLINE_MARKET,
			SUM( ONLINE_NET ) ONLINE_NET,
			SUM( NARROW_TOTAL ) NARROW_TOTAL,
			SUM( NARROW_MARKET ) NARROW_MARKET,
			SUM( NARROW_NET ) NARROW_NET,
			SUM( NARROW_MARKET_SJ ) NARROW_MARKET_SJ,
			SUM( NARROW_NET_SJ ) NARROW_NET_SJ 
FROM
	NGCS_WF_CMPLNTS_TS_FG WHERE 1=1   $customwhere$
	GROUP BY  AREA_NAME
	)
	UNION ALL 
	(
	SELECT 

			'合计' AS AREA_NAME ,
			SUM( BROAD_TOTAL ) BROAD_TOTAL,
			SUM( BROAD_MARKET ) BROAD_MARKET,
			SUM( BROAD_NET ) BROAD_NET,
			SUM( ONLINE_TOTAL ) ONLINE_TOTAL,
			SUM( ONLINE_MARKET ) ONLINE_MARKET,
			SUM( ONLINE_NET ) ONLINE_NET,
			SUM( NARROW_TOTAL ) NARROW_TOTAL,
			SUM( NARROW_MARKET ) NARROW_MARKET,
			SUM( NARROW_NET ) NARROW_NET,
			SUM( NARROW_MARKET_SJ ) NARROW_MARKET_SJ,
			SUM( NARROW_NET_SJ ) NARROW_NET_SJ  FROM
	NGCS_WF_CMPLNTS_TS_FG WHERE AREA_NAME !='异地' $customwhere$ ))
	 )  A  LEFT JOIN BS_T_SM_DICITEM ON A.AREA_NAME = BS_T_SM_DICITEM.DINAME||'市'
		WHERE BS_T_SM_DICITEM.DTID = '40288fca3cf76fda013cf779856b0002' OR A.AREA_NAME LIKE '合计%'  OR A.AREA_NAME LIKE '其他%' ORDER BY ORDERNUM ASC

		
	
	          ]]>
		</select>		
		<customwhere name="customwhere" prepend="and">
			<field prepend='and' operator='like' colname='ACPT_TIME' value='#time#' />
		</customwhere>
		<!-- <customwhere name="customwhere1" prepend="and">
			<field prepend='and' operator='like' colname='ACPT_TIME' value='#threeMonth#' />
		</customwhere> -->

	</sqlquery>
	
	
	
	<!-- 投诉情况分析报表-5G- -->
	<sqlquery	name="SQL_TS_FG_IN.query">
	<select>
	 <![CDATA[
	SELECT /*COUNT*/ A.* /*COUNT*/ FROM ( SELECT
CASE WHEN AREA_NAME = '全省' THEN '其他' ELSE AREA_NAME END AS AREA_NAME,
TOTAL_TOTAL,
TOTAL_MARKET,
to_char(round ( ( decode( TOTAL_TOTAL, 0, 0, TOTAL_MARKET / TOTAL_TOTAL )*100 ), 2),'fm99999999990.00')||'%' TOTAL_MARKET_RAT,
TOTAL_NET,
to_char(round( ( decode( TOTAL_TOTAL, 0, 0, TOTAL_NET / TOTAL_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' TOTAL_NET_RAT,
ANSWER_TOTAL,
ANSWER_MARKET,
to_char(round( ( decode( ANSWER_TOTAL, 0, 0, ANSWER_MARKET / ANSWER_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' ANSWER_MARKET_RAT,
ANSWER_NET,
to_char(round( ( decode( ANSWER_TOTAL, 0, 0, ANSWER_NET / ANSWER_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' ANSWER_NET_RAT,
NEED_FIRST_TOTAL,
NEED_FIRST_MARKET,
to_char(round( ( decode( NEED_FIRST_TOTAL, 0, 0, NEED_FIRST_MARKET / NEED_FIRST_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' NEED_FIRST_MARKET_RAT,
NEED_FIRST_NET,
to_char(round( ( decode( NEED_FIRST_TOTAL, 0, 0, NEED_FIRST_NET / NEED_FIRST_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' NEED_FIRST_NET_RAT,
NEED_FIRST_TRE,
to_char(round( ( decode( NEED_FIRST_TOTAL, 0, 0, NEED_FIRST_TRE / NEED_FIRST_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' NEED_FIRST_TRE_RAT,
NEED_FIRST_MARKET_TRE,
to_char(round( ( decode( NEED_FIRST_TOTAL, 0, 0, NEED_FIRST_MARKET_TRE / NEED_FIRST_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' NEED_FIRST_MARKET_TRE_RAT,
NEED_FIRST_NET_TRE,
to_char(round( ( decode( NEED_FIRST_TOTAL, 0, 0, NEED_FIRST_NET_TRE / NEED_FIRST_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' NEED_FIRST_NET_TRE_RAT,
NEED_SECOND_TOTAL,
NEED_SECOND_MARKET,
to_char(round( ( decode( NEED_SECOND_TOTAL, 0, 0, NEED_SECOND_MARKET / NEED_SECOND_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' NEED_SECOND_MARKET_RAT,
NEED_SECOND_NET,
to_char(round( ( decode( NEED_SECOND_TOTAL, 0, 0, NEED_SECOND_NET / NEED_SECOND_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' NEED_SECOND_NET_RAT,
ASSIST_FIRST_TOTAL,
ASSIST_FIRST_MARKET,
to_char(round( ( decode( ASSIST_FIRST_TOTAL, 0, 0, ASSIST_FIRST_MARKET / ASSIST_FIRST_TOTAL )*100 ), 2 ) ,'fm99999999990.00')||'%' ASSIST_FIRST_MARKET_RAT,
ASSIST_FIRST_NET,
to_char(round( ( decode( ASSIST_FIRST_TOTAL, 0, 0, ASSIST_FIRST_NET / ASSIST_FIRST_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' ASSIST_FIRST_NET_RAT
FROM ( (
SELECT
	AREA_NAME,
	SUM( ANSWER_TOTAL + NEED_FIRST_TOTAL + NEED_SECOND_TOTAL + ASSIST_FIRST_TOTAL ) AS TOTAL_TOTAL ,
	SUM( ANSWER_MARKET + NEED_FIRST_MARKET + NEED_SECOND_MARKET + ASSIST_FIRST_MARKET ) AS TOTAL_MARKET,
	SUM( ANSWER_NET + NEED_FIRST_NET + NEED_SECOND_NET + ASSIST_FIRST_NET ) AS TOTAL_NET,
	SUM( ANSWER_TOTAL ) AS ANSWER_TOTAL,
	SUM( ANSWER_MARKET ) AS ANSWER_MARKET,
	SUM( ANSWER_NET ) AS ANSWER_NET,
	SUM( NEED_FIRST_TOTAL ) AS NEED_FIRST_TOTAL,
	SUM( NEED_FIRST_MARKET ) AS NEED_FIRST_MARKET,
	SUM( NEED_FIRST_NET ) AS NEED_FIRST_NET,
	SUM( NEED_FIRST_TRE ) AS NEED_FIRST_TRE,
	SUM( NEED_FIRST_MARKET_TRE ) AS NEED_FIRST_MARKET_TRE,
	SUM( NEED_FIRST_NET_TRE ) AS NEED_FIRST_NET_TRE,
	SUM( NEED_SECOND_TOTAL ) AS NEED_SECOND_TOTAL,
	SUM( NEED_SECOND_MARKET ) AS NEED_SECOND_MARKET,
	SUM( NEED_SECOND_NET ) AS NEED_SECOND_NET,
	SUM( ASSIST_FIRST_TOTAL ) AS ASSIST_FIRST_TOTAL,
	SUM( ASSIST_FIRST_MARKET ) AS ASSIST_FIRST_MARKET,
	SUM( ASSIST_FIRST_NET ) AS ASSIST_FIRST_NET
FROM
	NGCS_WF_CMPLNTS_TS_FG_IN WHERE 1=1 $customwhere$
	GROUP BY AREA_NAME
	)
	UNION ALL 
	(
	SELECT 
	'合计' AS AREA_NAME ,
	SUM( ANSWER_TOTAL + NEED_FIRST_TOTAL + NEED_SECOND_TOTAL + ASSIST_FIRST_TOTAL ) AS TOTAL_TOTAL ,
	SUM( ANSWER_MARKET + NEED_FIRST_MARKET + NEED_SECOND_MARKET + ASSIST_FIRST_MARKET ) AS TOTAL_MARKET,
	SUM( ANSWER_NET + NEED_FIRST_NET + NEED_SECOND_NET + ASSIST_FIRST_NET ) AS TOTAL_NET,
	SUM( ANSWER_TOTAL ) AS ANSWER_TOTAL,
	SUM( ANSWER_MARKET ) AS ANSWER_MARKET,
	SUM( ANSWER_NET ) AS ANSWER_NET,
	SUM( NEED_FIRST_TOTAL ) AS NEED_FIRST_TOTAL,
	SUM( NEED_FIRST_MARKET ) AS NEED_FIRST_MARKET,
	SUM( NEED_FIRST_NET ) AS NEED_FIRST_NET,
	SUM( NEED_FIRST_TRE ) AS NEED_FIRST_TRE,
	SUM( NEED_FIRST_MARKET_TRE ) AS NEED_FIRST_MARKET_TRE,
	SUM( NEED_FIRST_NET_TRE ) AS NEED_FIRST_NET_TRE,
	SUM( NEED_SECOND_TOTAL ) AS NEED_SECOND_TOTAL,
	SUM( NEED_SECOND_MARKET ) AS NEED_SECOND_MARKET,
	SUM( NEED_SECOND_NET ) AS NEED_SECOND_NET,
	SUM( ASSIST_FIRST_TOTAL ) AS ASSIST_FIRST_TOTAL,
	SUM( ASSIST_FIRST_MARKET ) AS ASSIST_FIRST_MARKET,
	SUM( ASSIST_FIRST_NET ) AS ASSIST_FIRST_NET FROM
	NGCS_WF_CMPLNTS_TS_FG_IN WHERE  AREA_NAME !='异地' $customwhere$ ))
	 )  A  LEFT JOIN BS_T_SM_DICITEM ON A.AREA_NAME = BS_T_SM_DICITEM.DINAME||'市'
		WHERE BS_T_SM_DICITEM.DTID = '40288fca3cf76fda013cf779856b0002' OR A.AREA_NAME LIKE '合计%'   OR A.AREA_NAME LIKE '其他%'ORDER BY ORDERNUM ASC
		
	          ]]>
		</select>		
		<customwhere name="customwhere" prepend="and">
			<field prepend='and' operator='like' colname='ACPT_TIME' value='#time#' />
		</customwhere>
		<customwhere name="customwhere1" prepend="and">
			<field prepend='and' operator='like' colname='ACPT_TIME' value='#threeMonth#' />
		</customwhere>

	</sqlquery>
	
	
	
	<!-- 投诉数据总体情况报表 对内-月 -->
	<sqlquery name="SQL_TS_TOTAL_IN.query">

		<select>
            <![CDATA[
				SELECT /*COUNT*/ A.*  /*COUNT*/ FROM (
SELECT
		RESP_ACPT,
		
		TOTAL,
		TOTAL_MARKET_PERSONAL,
		TOTAL_MARKET_FAMILY,
		TOTAL_MARKET_ENTERPRISE,
		to_char(round( ( decode( TOTAL, 0, 0, ( TOTAL_MARKET_PERSONAL + TOTAL_MARKET_FAMILY + TOTAL_MARKET_ENTERPRISE ) / TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' TOTAL_MARKET_THAN,
		TOTAL_NET_PERSONAL,
		TOTAL_NET_FAMILY,
		TOTAL_NET_ENTERPRISE,
		to_char(round( ( decode( TOTAL, 0, 0, ( TOTAL_NET_PERSONAL + TOTAL_NET_FAMILY + TOTAL_NET_ENTERPRISE ) / TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' TOTAL_NET_THAN,
		TOTAL_XA,
		to_char(round( ( decode( TOTAL, 0, 0, ( TOTAL_XA ) / TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' TOTAL_XA_THAN,
		
		ANSWER_TOTAL,
		ANSWER_MARKET_PERSONAL,
		ANSWER_MARKET_FAMILY,
		ANSWER_MARKET_ENTERPRISE,
		to_char(round( ( decode( ANSWER_TOTAL, 0, 0, ( ANSWER_MARKET_PERSONAL + ANSWER_MARKET_FAMILY + ANSWER_MARKET_ENTERPRISE ) / ANSWER_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' ANSWER_MARKET_THAN,
		ANSWER_NET_PERSONAL,
		ANSWER_NET_FAMILY,
		ANSWER_NET_ENTERPRISE,
		to_char(round( ( decode( ANSWER_TOTAL, 0, 0, ( ANSWER_NET_PERSONAL + ANSWER_NET_FAMILY + ANSWER_NET_ENTERPRISE ) / ANSWER_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' ANSWER_NET_THAN,
		ANSWER_XA,
		to_char(round( ( decode( ANSWER_TOTAL, 0, 0, ( ANSWER_XA ) / ANSWER_TOTAL ) * 100), 2 ),'fm99999999990.00')||'%' ANSWER_XA_THAN,
		
		NEED_ONE_TOTAL,
		NEED_ONE_TRE,
		to_char(round( ( decode( NEED_ONE_TOTAL, 0, 0, ( NEED_ONE_TRE ) / NEED_ONE_TOTAL ) * 100), 2 ),'fm99999999990.00')||'%' NEED_ONE_TRE_THAN,
		NEED_MARKET_PERSONAL,
		NEED_MARKET_FAMILY,
		NEED_MARKET_ENTERPRISE,
		to_char(round( ( decode( NEED_ONE_TOTAL, 0, 0, ( NEED_MARKET_PERSONAL + NEED_MARKET_FAMILY + NEED_MARKET_ENTERPRISE ) / NEED_ONE_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' NEED_ONE_MARKET_THAN,
		NEED_ONE_MARKET_TRE,
		NEED_NET_PERSONAL,
		NEED_NET_FAMILY,
		NEED_NET_ENTERPRISE,
		to_char(round( ( decode( NEED_ONE_TOTAL, 0, 0, ( NEED_ONE_MARKET_TRE + NEED_NET_FAMILY + NEED_NET_ENTERPRISE ) / NEED_ONE_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' NEED_ONE_NET_THAN,
		NEED_ONE_NET_TRE,
		NEED_ONE_GOVER,
		to_char(round( ( decode( NEED_ONE_TOTAL, 0, 0, ( NEED_ONE_GOVER ) / NEED_ONE_TOTAL ) * 100), 2 ),'fm99999999990.00')||'%' NEED_ONE_GOVER_THAN,
		NEED_ONE_GOVER_TRE,
		NEED_TWO_TOTAL,
		NEED_TWO_MARKET_PERSONAL,
		NEED_TWO_MARKET_FAMILY,
		NEED_TWO_MARKET_ENTERPRISE,
		to_char(round( ( decode( NEED_TWO_TOTAL, 0, 0, ( NEED_TWO_MARKET_PERSONAL + NEED_TWO_MARKET_FAMILY + NEED_TWO_MARKET_ENTERPRISE ) / NEED_TWO_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' NEED_TWO_MARKET_THAN,
		NEED_TWO_NET_PERSONAL,
		NEED_TWO_NET_FAMILY,
		NEED_TWO_NET_ENTERPRISE,
		to_char(round( ( decode( NEED_TWO_TOTAL, 0, 0, ( NEED_TWO_NET_PERSONAL + NEED_TWO_NET_FAMILY + NEED_TWO_NET_ENTERPRISE ) / NEED_TWO_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' NEED_TWO_NET_THAN,
		NEED_TWO_XA,
		to_char(round( ( decode( NEED_TWO_TOTAL, 0, 0, ( NEED_TWO_XA ) / NEED_TWO_TOTAL ) * 100), 2 ),'fm99999999990.00')||'%' NEED_TWO_XA_THAN,
		
		ASSIST_ONE_TOTAL,
		ASSIST_ONE_MARKET_PERSONAL,
		ASSIST_ONE_MARKET_FAMILY,
		ASSIST_ONE_MARKET_ENTERPRISE,
		to_char(round( ( decode( ASSIST_ONE_TOTAL, 0, 0, ( ASSIST_ONE_MARKET_PERSONAL + ASSIST_ONE_MARKET_FAMILY + ASSIST_ONE_MARKET_ENTERPRISE ) / ASSIST_ONE_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' ASSIST_ONE_MARKET_THAN,
		ASSIST_ONE_NET_PERSONAL,
		ASSIST_ONE_NET_FAMILY,
		ASSIST_ONE_NET_ENTERPRISE,
		to_char(round( ( decode( ASSIST_ONE_TOTAL, 0, 0, ( ASSIST_ONE_NET_PERSONAL + ASSIST_ONE_NET_FAMILY + ASSIST_ONE_NET_ENTERPRISE ) / ASSIST_ONE_TOTAL )*100 ), 2 ),'fm99999999990.00')||'%' ASSIST_ONE_NET_THAN,
		ASSIST_ONE_XA,
		to_char(round( ( decode( ASSIST_ONE_TOTAL, 0, 0, ( ASSIST_ONE_XA ) / ASSIST_ONE_TOTAL ) * 100), 2 ),'fm99999999990.00')||'%' ASSIST_ONE_XA_THAN,
		ASSIST_TWO_TOTAL

		
	FROM ( (
SELECT
		nvl( CASE WHEN  (RESP_ACPT LIKE '全省' OR RESP_ACPT LIKE '异地' OR RESP_ACPT LIKE '其他'  ) THEN '其他' ELSE RESP_ACPT END ,'合计') AS RESP_ACPT ,
		SUM( TOTAL_TOTAL ) TOTAL,
		SUM( TOTAL_MARKET_PERSONAL ) TOTAL_MARKET_PERSONAL,
		SUM( TOTAL_MARKET_FAMILY ) TOTAL_MARKET_FAMILY,
		SUM( TOTAL_MARKET_ENTERPRISE ) TOTAL_MARKET_ENTERPRISE,
		SUM( TOTAL_NET_PERSONAL ) TOTAL_NET_PERSONAL,
		SUM( TOTAL_NET_FAMILY ) TOTAL_NET_FAMILY,
		SUM( TOTAL_NET_ENTERPRISE ) TOTAL_NET_ENTERPRISE,	
		SUM( TOTAL_XA ) TOTAL_XA,
		
		SUM( ANSWER_TOTAL ) ANSWER_TOTAL,
		SUM( ANSWER_MARKET_PERSONAL ) ANSWER_MARKET_PERSONAL,
		SUM( ANSWER_MARKET_FAMILY ) ANSWER_MARKET_FAMILY,
		SUM( ANSWER_MARKET_ENTERPRISE ) ANSWER_MARKET_ENTERPRISE,
		SUM( ANSWER_NET_PERSONAL ) ANSWER_NET_PERSONAL,
		SUM( ANSWER_NET_FAMILY ) ANSWER_NET_FAMILY,
		SUM( ANSWER_NET_ENTERPRISE ) ANSWER_NET_ENTERPRISE,
		SUM( ANSWER_XA ) ANSWER_XA,
		SUM( NEED_ONE_TOTAL ) NEED_ONE_TOTAL,
		SUM( NEED_ONE_TRE ) NEED_ONE_TRE,
		SUM( NEED_MARKET_PERSONAL ) NEED_MARKET_PERSONAL,
		SUM( NEED_MARKET_FAMILY ) NEED_MARKET_FAMILY,
		SUM( NEED_MARKET_ENTERPRISE ) NEED_MARKET_ENTERPRISE,
		SUM( NEED_ONE_MARKET_TRE ) NEED_ONE_MARKET_TRE,
		SUM( NEED_NET_PERSONAL ) NEED_NET_PERSONAL,
		SUM( NEED_NET_FAMILY ) NEED_NET_FAMILY,
		SUM( NEED_NET_ENTERPRISE ) NEED_NET_ENTERPRISE,
		SUM( NEED_ONE_NET_TRE ) NEED_ONE_NET_TRE,
		SUM( NEED_ONE_GOVER ) NEED_ONE_GOVER,
		SUM( NEED_ONE_GOVER_TRE ) NEED_ONE_GOVER_TRE,
		SUM( NEED_TWO_TOTAL ) NEED_TWO_TOTAL,
		SUM( NEED_TWO_MARKET_PERSONAL ) NEED_TWO_MARKET_PERSONAL,
		SUM( NEED_TWO_MARKET_FAMILY ) NEED_TWO_MARKET_FAMILY,
		SUM( NEED_TWO_MARKET_ENTERPRISE ) NEED_TWO_MARKET_ENTERPRISE,
		SUM( NEED_TWO_NET_PERSONAL ) NEED_TWO_NET_PERSONAL,
		SUM( NEED_TWO_NET_FAMILY ) NEED_TWO_NET_FAMILY,
		SUM( NEED_TWO_NET_ENTERPRISE ) NEED_TWO_NET_ENTERPRISE,
		SUM( NEED_TWO_XA ) NEED_TWO_XA,
		SUM( ASSIST_ONE_TOTAL ) ASSIST_ONE_TOTAL,
		SUM( ASSIST_ONE_MARKET_PERSONAL ) ASSIST_ONE_MARKET_PERSONAL,
		SUM( ASSIST_ONE_MARKET_FAMILY ) ASSIST_ONE_MARKET_FAMILY,
		SUM( ASSIST_ONE_MARKET_ENTERPRISE ) ASSIST_ONE_MARKET_ENTERPRISE,
		SUM( ASSIST_ONE_NET_PERSONAL ) ASSIST_ONE_NET_PERSONAL,
		SUM( ASSIST_ONE_NET_FAMILY ) ASSIST_ONE_NET_FAMILY,
		SUM( ASSIST_ONE_NET_ENTERPRISE ) ASSIST_ONE_NET_ENTERPRISE,
		SUM( ASSIST_ONE_XA ) ASSIST_ONE_XA,
		SUM( ASSIST_TWO_TOTAL ) ASSIST_TWO_TOTAL
	FROM
		NGCS_WF_CMPLNTS_TS_TOTAL_IN 
		WHERE 1=1  $customwhere$
		GROUP BY rollup(CASE WHEN  (RESP_ACPT LIKE '全省' OR RESP_ACPT LIKE '异地' OR RESP_ACPT LIKE '其他'  ) THEN '其他' ELSE RESP_ACPT END)
		)
		
		) )  A  order by /*ORDERBY*/ instr('沈阳,大连,鞍山,抚顺,本溪,丹东,锦州,营口,阜新,辽阳,铁岭,朝阳,盘锦,葫芦,其他,合计',substr(RESP_ACPT,0,2)) /*ORDERBY*/
              ]]>
		</select>
		<customwhere name="customwhere" prepend="and">
			<field prepend='and' operator='like' colname='ACPT_TIME' value='#time#' />
		</customwhere>
	</sqlquery>
	
	
	
	<!-- 费用质疑投诉总体情况报表-集团 -->
	<sqlquery name="SQL_TS_FYZY_JT.query">

		<select>
            <![CDATA[
		SELECT /*COUNT*/TA.*,
		to_char(round(decode( complaints_max, 0, 0, ( ( complaints_max - complaints_min ) / complaints_max * 1 )*100) ,2),'fm99999999990.00') || '%' complaints_rat
		 /*COUNT*/ FROM(
		 SELECT 
		nvl(CASE WHEN 
			(AREA_NAME='异地' OR AREA_NAME='全省' OR AREA_NAME='其他' )
			THEN '其他' ELSE AREA_NAME END ,'合计') AREA_NAME ,
		$customwhere0$ AS COMPLAINTS,
		$customwhere1$ AS COMPLAINTS_MAX ,
		$customwhere2$ AS COMPLAINTS_MIN 
			FROM NGCS_WF_CMPLNTS_TS_COST_JT WHERE 1=1  group by rollup(AREA_NAME)
			) TA order by instr('全省,沈阳,大连,鞍山,抚顺,本溪,丹东,锦州,营口,阜新,辽阳,铁岭,朝阳,盘锦,葫芦,其他,合计',substr(AREA_NAME,0,2)) 
              ]]>
		</select>
		<customwhere name="customwhere0" prepend="">
			<!-- <field prepend='and' operator='like' colname='ACPT_TIME' value='#time#' /> -->
			 <if exp="'#time#'>''">
                <success>
                    <![CDATA[ SUM(CASE WHEN 
			(ACPT_TIME like #time#||'%' )
			THEN 1 ELSE 0 END)  ]]>
                </success>
                <else>
                	0
                </else>
            </if>
		</customwhere>
		<customwhere name="customwhere1" prepend="">
			<!-- <field prepend='and' operator='like' colname='ACPT_TIME' value='#time#' /> -->
			 <if exp="'#time#'>''">
                <success>
                    <![CDATA[ SUM(CASE WHEN 
			(ACPT_TIME BETWEEN (select  to_char(add_months(to_date( #time# , 'yyyy-mm' ),-1), 'yyyy-MM' )||'-26'  from dual) 
			AND (select  to_char(to_date(  #time# , 'yyyy-mm' ), 'yyyy-MM' )||'-05'  from dual))
			THEN 1 ELSE 0 END)  ]]>
                </success>
                <else>
                	0
                </else>
            </if>
		</customwhere>
		<customwhere name="customwhere2" prepend="">
			<!-- <field prepend='and' operator='like' colname='ACPT_TIME' value='#time#' /> -->
			 <if exp="'#time#'>''">
                <success>
                    <![CDATA[ SUM(CASE WHEN 
			(ACPT_TIME BETWEEN (select  to_char(to_date(  #time#, 'yyyy-mm' ), 'yyyy-MM' )||'-16'  from dual) 
			AND (select  to_char(to_date(  #time# , 'yyyy-mm' ), 'yyyy-MM' )||'-25'  from dual)) 
			THEN 1 ELSE 0 END)   ]]>
                </success>
                <else>
                	0
                </else>
            </if>
		</customwhere>
		<customwhere name="customwhere" prepend="and">
			<field prepend='and' operator='like' colname='ACPT_TIME' value='#time#' /> 
		</customwhere>
	</sqlquery>
	<!-- <sqlquery name="SQL_TS_FYZY_JT.query">

		<select>
            <![CDATA[
				SELECT
/*COUNT*/A.* /*COUNT*/
	
FROM
	(
	SELECT
		CASE WHEN AREA_NAME =  '全省'   THEN '其他'  ELSE AREA_NAME END AS AREA_NAME,
		complaints,
		complaints_max,
		complaints_min,
		to_char(round(decode( complaints_max, 0, 0, ( ( complaints_max - complaints_min ) / complaints_max * 1 )*100) ,2),'fm99999999990.00') || '%' complaints_rat
	FROM
		(
		SELECT
			AREA_NAME,
			sum( complaints ) AS complaints,
			sum( complaints_max ) AS complaints_max,
			sum( complaints_min ) AS complaints_min 
		FROM
			(
			SELECT
				AREA_NAME ,
				complaints,

				complaints_max,
				complaints_min 
			FROM
				NGCS_WF_CMPLNTS_TS_COST_JT
			WHERE
				1=1  $customwhere$
			) 
		GROUP BY
			AREA_NAME
		UNION ALL 
	(
	SELECT 

			'合计' AS AREA_NAME ,
			sum( complaints ) AS complaints,
			sum( complaints_max ) AS complaints_max,
			sum( complaints_min ) AS complaints_min   FROM
	NGCS_WF_CMPLNTS_TS_COST_JT WHERE AREA_NAME !='异地' $customwhere$))
		
	) A  LEFT JOIN BS_T_SM_DICITEM ON A.AREA_NAME = BS_T_SM_DICITEM.DINAME||'市'
		WHERE BS_T_SM_DICITEM.DTID = '40288fca3cf76fda013cf779856b0002' OR A.AREA_NAME LIKE '合计%' OR A.AREA_NAME LIKE '其他%' ORDER BY ORDERNUM ASC
				
				
              ]]>
		</select>
		<customwhere name="customwhere" prepend="and">
			<field prepend='and' operator='like' colname='ACPT_TIME' value='#time#' />
		</customwhere>
	</sqlquery> -->
	
	
	
	<!-- 重复投诉明细（集团口径） -->
	<sqlquery name="SQL_Detail_Complain_Group_Dw.query">

		<select>
            <![CDATA[
				SELECT /*COUNT*/ * /*COUNT*/ FROM DW_COMPLAIN_GROUP_DETAIL WHERE 1=1 $customwhere$
              ]]>
		</select>
		<condition  cols="1" labprecent="11" textprecent="22" >
            <date displayname="统计日期" name="statisdate" class='Wdate' dateFmt='yyyyMMdd' defaultvalue="#statisdate#"  />
        	<text displayname='服务请求类别' name='srvreqsttypefullnm' />
        </condition>
		<customwhere name="customwhere" prepend="and">
			<field prepend='and' operator='like' colname='STATIS_DATE' value='#statisdate#' />
			<field prepend='and' operator='like' colname='SRV_REQST_TYPE_FULL_NM' value='#srvreqsttypefullnm#' />
		</customwhere>
	</sqlquery>
	
	
	<!-- 重复投诉明细（省内口径） -->
	<sqlquery name="SQL_Detail_Complain_Loc_Dw.query">

		<select>
            <![CDATA[
				SELECT /*COUNT*/ * /*COUNT*/ FROM DW_COMPLAIN_LOC_DETAIL WHERE 1=1 $customwhere$
              ]]>
		</select>
		<condition  cols="1" labprecent="11" textprecent="22" >
            <date displayname="统计日期" name="statisdate" class='Wdate' dateFmt='yyyyMMdd' defaultvalue="#statisdate#"  />
        	<text displayname='服务请求类别' name='srvreqsttypefullnm' />
        </condition>
		<customwhere name="customwhere" prepend="and">
			<field prepend='and' operator='like' colname='STATIS_DATE' value='#statisdate#' />
			<field prepend='and' operator='like' colname='SRV_REQST_TYPE_FULL_NM' value='#srvreqsttypefullnm#' />
		</customwhere>
	</sqlquery>
	
	<!-- 重复投诉汇总（集团口径） -->
	<sqlquery name="SQL_Detail_Complain_Group_St.query">

		<select>
            <![CDATA[
				SELECT /*COUNT*/ * /*COUNT*/ FROM ST_COMPLAIN_GROUP_DETAIL WHERE 1=1 $customwhere$
              ]]>
		</select>
		<condition  cols="1" labprecent="11" textprecent="22" >
            <!-- <date displayname="统计日期" name="statis_date" class='Wdate' dateFmt='yyyyMMdd' defaultvalue="#statis_date#"  /> -->
        	<text displayname='服务请求类别' name='typelv6' />
        </condition>
		<customwhere name="customwhere" prepend="and">
			<!-- <field prepend='and' operator='like' colname='STATIS_DATE' value='#statis_date#' /> -->
			<field prepend='and' operator='like' colname='TYPE_LV6' value='#typelv6#' />
		</customwhere>
	</sqlquery>
	
	<!-- 重复投诉汇总（省内口径） -->
	<sqlquery name="SQL_Detail_Complain_Loc_St.query">

		<select>
            <![CDATA[
				SELECT /*COUNT*/ * /*COUNT*/ FROM ST_COMPLAIN_LOC_DETAIL WHERE 1=1
				 $customwhere$
              ]]>
		</select>
		<condition  cols="1" labprecent="11" textprecent="22" >
            <!-- <date displayname="统计日期" name="statis_date" class='Wdate' dateFmt='yyyyMMdd' defaultvalue="#statis_date#"  />-->
            <text displayname='服务请求类别' name='typelv6' />
        </condition>
		<customwhere name="customwhere" prepend="and">
			<!-- <field prepend='and' operator='like' colname='STATIS_DATE' value='#statis_date#' /> -->
			<field prepend='and' operator='like' colname='TYPE_LV6' value='#typelv6#' />
		</customwhere>
	</sqlquery>
	
	
	
	<!--重复投诉总体情况报表-对外-->
	<sqlquery name="SQL_TS_REPEAT_SN.query">

		<select>
            <![CDATA[
					SELECT /*COUNT*/
	AREA_NAME,
	REPEAT_COUNT,
	VALUEG,	
	to_char(round( ( decode( VALUEG , 0, 0,  REPEAT_COUNT / VALUEG ) * 100) , 2 ),'fm99999999990.00')||'%' REPEAT_COUNT_RAT,
	REPEAT_SJ,
	to_char(round( ( decode( REPEAT_COUNT , 0, 0,  REPEAT_SJ  / REPEAT_COUNT ) * 100) , 2 ),'fm99999999990.00')||'%' REPEAT_SJ_RAT,
	REPEAT_MARKET_PERSONA,
	REPEAT_MARKET_FAMILY,
	REPEAT_MARKET_ENTERPRISE,
	to_char(round( ( decode( REPEAT_COUNT , 0, 0,  REPEAT_MARKET  / REPEAT_COUNT ) * 100) , 2 ),'fm99999999990.00')||'%' REPEAT_MARKET_RAT,
	to_char(round( ( decode( TOTAL_MARKET , 0, 0,  REPEAT_MARKET  / TOTAL_MARKET ) * 100) , 2 ),'fm99999999990.00')||'%' REPEAT_MARKET_RAT1,
	REPEAT_MARKET_SJ,
	to_char(round( ( decode( REPEAT_MARKET , 0, 0,  REPEAT_MARKET_SJ  / REPEAT_MARKET ) * 100) , 2 ),'fm99999999990.00')||'%' REPEAT_MARKET_SJ_RAT,
	REPEAT_NET_PERSONA,
	REPEAT_NET_FAMILY,
	REPEAT_NET_ENTERPRISE,
	to_char(round( ( decode( REPEAT_COUNT , 0, 0,  REPEAT_NET  / REPEAT_COUNT ) * 100) , 2 ),'fm99999999990.00')||'%' REPEAT_NET_RAT,
	to_char(round( ( decode( TOTAL_NET , 0, 0,  REPEAT_NET  / TOTAL_NET ) * 100) , 2 ),'fm99999999990.00')||'%'  REPEAT_NET_RAT1,
	REPEAT_NET_SJ,
	to_char(round( ( decode( REPEAT_NET , 0, 0,  REPEAT_NET_SJ  / REPEAT_NET ) * 100) , 2 ),'fm99999999990.00')||'%' REPEAT_NET_SJ_RAT,
	REPEAT_XA,
	to_char(round( ( decode( REPEAT_COUNT , 0, 0,  REPEAT_XA  / REPEAT_COUNT ) * 100) , 2 ),'fm99999999990.00')||'%' REPEAT_XA_RAT,
	to_char(round( ( decode( TOTAL_XA , 0, 0,  REPEAT_XA  / TOTAL_XA ) * 100) , 2 ),'fm99999999990.00')||'%' REPEAT_XA_RAT1,
	REPEAT_XA_SJ,
	to_char(round( ( decode( REPEAT_XA , 0, 0,  REPEAT_XA_SJ  / REPEAT_XA ) * 100) , 2 ),'fm99999999990.00')||'%' REPEAT_XA_SJ_RAT /*COUNT*/
FROM (
SELECT * FROM
(SELECT ta.*,tb.VALUEG,tb.TOTAL_MARKET,tb.TOTAL_NET,tb.TOTAL_XA FROM (
SELECT
	nvl( (CASE WHEN  ( AREA_NAME LIKE '%全省%' or AREA_NAME LIKE '%其他%' or AREA_NAME LIKE '%异地%' ) 
	THEN '其他' ELSE AREA_NAME END ),'合计' ) AREA_NAME,
	SUM( CNT_CF ) REPEAT_COUNT,
	SUM( CNT_UP_COMPLIAN ) REPEAT_SJ,
	SUM( CASE WHEN ( ORG_DEPARTMENT = '市场类' AND ORG_BUSI = '个人市场' ) THEN 1 ELSE 0 END ) AS REPEAT_MARKET_PERSONA,
	SUM( CASE WHEN ( ORG_DEPARTMENT = '市场类' AND ORG_BUSI = '家庭市场' ) THEN 1 ELSE 0 END ) AS REPEAT_MARKET_FAMILY,
	SUM( CASE WHEN ( ORG_DEPARTMENT = '市场类' AND ORG_BUSI = '政企市场' ) THEN 1 ELSE 0 END ) AS REPEAT_MARKET_ENTERPRISE,
	SUM( CASE WHEN ORG_DEPARTMENT = '市场类' THEN 1 ELSE 0 END ) AS REPEAT_MARKET,
	SUM( CASE WHEN ( ORG_DEPARTMENT = '市场类' AND IS_UP_COMPLAIN = '是' ) THEN 1 ELSE 0 END ) AS REPEAT_MARKET_SJ,
	SUM( CASE WHEN ( ORG_DEPARTMENT = '网络类' AND ORG_BUSI = '个人网络' ) THEN 1 ELSE 0 END ) AS REPEAT_NET_PERSONA,
	SUM( CASE WHEN ( ORG_DEPARTMENT = '网络类' AND ORG_BUSI = '家庭网络' ) THEN 1 ELSE 0 END ) AS REPEAT_NET_FAMILY,
	SUM( CASE WHEN ( ORG_DEPARTMENT = '网络类' AND ORG_BUSI = '政企网络' ) THEN 1 ELSE 0 END ) AS REPEAT_NET_ENTERPRISE,
	SUM( CASE WHEN ORG_DEPARTMENT = '网络类' THEN 1 ELSE 0 END ) AS REPEAT_NET,
	SUM( CASE WHEN ( ORG_DEPARTMENT = '网络类' AND IS_UP_COMPLAIN = '是' ) THEN 1 ELSE 0 END ) AS REPEAT_NET_SJ,
	SUM( CASE WHEN ( ORG_DEPARTMENT = '信安类' ) THEN 1 ELSE 0 END ) AS REPEAT_XA,
	SUM( CASE WHEN ( ORG_DEPARTMENT = '信安类' AND IS_UP_COMPLAIN = '是' ) THEN 1 ELSE 0 END ) AS REPEAT_XA_SJ
FROM
	( SELECT 
		CASE WHEN AREA_NAME = '全省' OR AREA_NAME = '异地' THEN '其他' ELSE AREA_NAME END AS AREA_NAME,ACPT_NUM,TYPE_LV6,CNT_CF,ORG_DEPARTMENT,ORG_BUSI,IS_UP_COMPLAIN,CNT_UP_COMPLIAN,SYNCDATE FROM
		ST_COMPLAIN_LOC_DETAIL WHERE 1 = 1 $customwhere1$ )
GROUP BY
	rollup(CASE WHEN  ( AREA_NAME LIKE '%全省%' or AREA_NAME LIKE '%其他%' or AREA_NAME LIKE '%异地%' ) 
	THEN '其他' ELSE AREA_NAME END ) ) ta 
LEFT JOIN 
	( SELECT nvl(AREA_NAME,'合计') as AREA_NAME, SUM( VALUEG ) VALUEG ,SUM(BROAD_MARKET_PERSONAL+BROAD_MARKET_FAMILY+BROAD_MARKET_ENTERPRISE) AS TOTAL_MARKET,SUM(BROAD_NET_PERSONAL+BROAD_NET_FAMILY+BROAD_NET_ENTERPRISE) AS TOTAL_NET,SUM(BROAD_XA) AS TOTAL_XA
	FROM ( SELECT CASE WHEN (RESP_ACPT = '全省' OR RESP_ACPT = '异地' OR RESP_ACPT = '其他') THEN '其他' ELSE RESP_ACPT END AS AREA_NAME,VALUEG,BROAD_MARKET_PERSONAL,BROAD_MARKET_FAMILY,BROAD_MARKET_ENTERPRISE,BROAD_NET_PERSONAL,BROAD_NET_FAMILY,BROAD_NET_ENTERPRISE,BROAD_XA FROM NGCS_WF_CMPLNTS_TS_TOTAL 
	WHERE 1 = 1 $customwhere2$ )
	GROUP BY rollup(AREA_NAME) ) tb  ON  ta.AREA_NAME = tb.AREA_NAME )
)  order by /*ORDERBY*/ instr('全省,沈阳,大连,鞍山,抚顺,本溪,丹东,锦州,营口,阜新,辽阳,铁岭,朝阳,盘锦,葫芦,其他,合计',substr(AREA_NAME,0,2))			
              ]]>
		</select>
		<customwhere name="customwhere1" prepend="and">
			<field prepend='and' operator='like' colname='SYNCDATE' value='#time#' /> 
		</customwhere> 
		<customwhere name="customwhere2" prepend="and">
			<field prepend='and' operator='like' colname='ACPT_TIME' value='#time#' /> 
		</customwhere> 

	</sqlquery>
	
	
	<!--重复投诉总体情况报表-对外-->
	<sqlquery name="SQL_TS_REPEAT_JT.query">
		<select>
            <![CDATA[
            	SELECT /*COUNT*/
	AREA_NAME,
	REPEAT_COUNT,
	VALUEG,	
	to_char(round( ( decode( VALUEG , 0, 0,  REPEAT_COUNT / VALUEG ) * 100) , 2 ),'fm99999999990.00')||'%' REPEAT_COUNT_RAT,
	REPEAT_SJ,
	to_char(round( ( decode( REPEAT_COUNT , 0, 0,  REPEAT_SJ  / REPEAT_COUNT ) * 100) , 2 ),'fm99999999990.00')||'%' REPEAT_SJ_RAT,
	REPEAT_MARKET_PERSONA,
	REPEAT_MARKET_FAMILY,
	REPEAT_MARKET_ENTERPRISE,
	to_char(round( ( decode( REPEAT_COUNT , 0, 0,  REPEAT_MARKET  / REPEAT_COUNT ) * 100) , 2 ),'fm99999999990.00')||'%' REPEAT_MARKET_RAT,
	to_char(round( ( decode( TOTAL_MARKET , 0, 0,  REPEAT_MARKET  / TOTAL_MARKET ) * 100) , 2 ),'fm99999999990.00')||'%' REPEAT_MARKET_RAT1,
	REPEAT_MARKET_SJ,
	to_char(round( ( decode( REPEAT_MARKET , 0, 0,  REPEAT_MARKET_SJ  / REPEAT_MARKET ) * 100) , 2 ),'fm99999999990.00')||'%' REPEAT_MARKET_SJ_RAT,
	REPEAT_NET_PERSONA,
	REPEAT_NET_FAMILY,
	REPEAT_NET_ENTERPRISE,
	to_char(round( ( decode( REPEAT_COUNT , 0, 0,  REPEAT_NET  / REPEAT_COUNT ) * 100) , 2 ),'fm99999999990.00')||'%' REPEAT_NET_RAT,
	to_char(round( ( decode( TOTAL_NET , 0, 0,  REPEAT_NET  / TOTAL_NET ) * 100) , 2 ),'fm99999999990.00')||'%'  REPEAT_NET_RAT1,
	REPEAT_NET_SJ,
	to_char(round( ( decode( REPEAT_NET , 0, 0,  REPEAT_NET_SJ  / REPEAT_NET ) * 100) , 2 ),'fm99999999990.00')||'%' REPEAT_NET_SJ_RAT,
	REPEAT_XA,
	to_char(round( ( decode( REPEAT_COUNT , 0, 0,  REPEAT_XA  / REPEAT_COUNT ) * 100) , 2 ),'fm99999999990.00')||'%' REPEAT_XA_RAT,
	to_char(round( ( decode( TOTAL_XA , 0, 0,  REPEAT_XA  / TOTAL_XA ) * 100) , 2 ),'fm99999999990.00')||'%' REPEAT_XA_RAT1,
	REPEAT_XA_SJ,
	to_char(round( ( decode( REPEAT_XA , 0, 0,  REPEAT_XA_SJ  / REPEAT_XA ) * 100) , 2 ),'fm99999999990.00')||'%' REPEAT_XA_SJ_RAT /*COUNT*/
FROM (
SELECT * FROM
(SELECT ta.*,tb.VALUEG,tb.TOTAL_MARKET,tb.TOTAL_NET,tb.TOTAL_XA FROM (
SELECT
	nvl( (CASE WHEN  ( AREA_NAME LIKE '%全省%' or AREA_NAME LIKE '%其他%' or AREA_NAME LIKE '%异地%' ) THEN '其他' ELSE AREA_NAME END ),'合计' ) AREA_NAME,
	SUM( CNT_CF ) REPEAT_COUNT,
	SUM( CNT_UP_COMPLIAN ) REPEAT_SJ,
	SUM( CASE WHEN ( ORG_DEPARTMENT = '市场类' AND ORG_BUSI = '个人市场' ) THEN 1 ELSE 0 END ) AS REPEAT_MARKET_PERSONA,
	SUM( CASE WHEN ( ORG_DEPARTMENT = '市场类' AND ORG_BUSI = '家庭市场' ) THEN 1 ELSE 0 END ) AS REPEAT_MARKET_FAMILY,
	SUM( CASE WHEN ( ORG_DEPARTMENT = '市场类' AND ORG_BUSI = '政企市场' ) THEN 1 ELSE 0 END ) AS REPEAT_MARKET_ENTERPRISE,
	SUM( CASE WHEN ORG_DEPARTMENT = '市场类' THEN 1 ELSE 0 END ) AS REPEAT_MARKET,
	SUM( CASE WHEN ( ORG_DEPARTMENT = '市场类' AND IS_UP_COMPLAIN = '是' ) THEN 1 ELSE 0 END ) AS REPEAT_MARKET_SJ,
	
	
	SUM( CASE WHEN ( ORG_DEPARTMENT = '网络类' AND ORG_BUSI = '个人网络' ) THEN 1 ELSE 0 END ) AS REPEAT_NET_PERSONA,
	SUM( CASE WHEN ( ORG_DEPARTMENT = '网络类' AND ORG_BUSI = '家庭网络' ) THEN 1 ELSE 0 END ) AS REPEAT_NET_FAMILY,
	SUM( CASE WHEN ( ORG_DEPARTMENT = '网络类' AND ORG_BUSI = '政企网络' ) THEN 1 ELSE 0 END ) AS REPEAT_NET_ENTERPRISE,
	SUM( CASE WHEN ORG_DEPARTMENT = '网络类' THEN 1 ELSE 0 END ) AS REPEAT_NET,
	SUM( CASE WHEN ( ORG_DEPARTMENT = '网络类' AND IS_UP_COMPLAIN = '是' ) THEN 1 ELSE 0 END ) AS REPEAT_NET_SJ,
	
	
	SUM( CASE WHEN ( ORG_DEPARTMENT = '信安类' ) THEN 1 ELSE 0 END ) AS REPEAT_XA,
	SUM( CASE WHEN ( ORG_DEPARTMENT = '信安类' AND IS_UP_COMPLAIN = '是' ) THEN 1 ELSE 0 END ) AS REPEAT_XA_SJ
FROM
	( SELECT 
		CASE WHEN AREA_NAME = '全省' OR AREA_NAME = '异地' THEN '其他' ELSE AREA_NAME END AS AREA_NAME,ACPT_NUM,TYPE_LV6,CNT_CF,ORG_DEPARTMENT,ORG_BUSI,IS_UP_COMPLAIN,CNT_UP_COMPLIAN,SYNCDATE FROM
		ST_COMPLAIN_GROUP_DETAIL  WHERE 1 = 1 $customwhere1$ )
GROUP BY rollup (CASE WHEN  ( AREA_NAME LIKE '%全省%' or AREA_NAME LIKE '%其他%' or AREA_NAME LIKE '%异地%' ) THEN '其他' ELSE AREA_NAME END )  ) ta 
LEFT JOIN 
	( SELECT nvl( (CASE WHEN  ( AREA_NAME LIKE '%全省%' or AREA_NAME LIKE '%其他%' or AREA_NAME LIKE '%异地%' ) THEN '其他' ELSE AREA_NAME END ),'合计' ) AREA_NAME, SUM( VALUEG ) VALUEG ,SUM(BROAD_MARKET_PERSONAL+BROAD_MARKET_FAMILY+BROAD_MARKET_ENTERPRISE) AS TOTAL_MARKET,SUM(BROAD_NET_PERSONAL+BROAD_NET_FAMILY+BROAD_NET_ENTERPRISE) AS TOTAL_NET,SUM(BROAD_XA) AS TOTAL_XA
	FROM ( SELECT CASE WHEN (RESP_ACPT = '全省' OR RESP_ACPT = '异地' OR RESP_ACPT = '其他') THEN '其他' ELSE RESP_ACPT END AS AREA_NAME,VALUEG,BROAD_MARKET_PERSONAL,BROAD_MARKET_FAMILY,BROAD_MARKET_ENTERPRISE,BROAD_NET_PERSONAL,BROAD_NET_FAMILY,BROAD_NET_ENTERPRISE,BROAD_XA FROM NGCS_WF_CMPLNTS_TS_TOTAL 
	 WHERE 1 = 1 $customwhere2$ )
	GROUP BY rollup (CASE WHEN  ( AREA_NAME LIKE '%全省%' or AREA_NAME LIKE '%其他%' or AREA_NAME LIKE '%异地%' ) THEN '其他' ELSE AREA_NAME END ) ) tb  ON  ta.AREA_NAME = tb.AREA_NAME ) )
	order by /*ORDERBY*/ instr('全省,沈阳,大连,鞍山,抚顺,本溪,丹东,锦州,营口,阜新,辽阳,铁岭,朝阳,盘锦,葫芦,其他,合计',substr(AREA_NAME,0,2))
		 ]]>
		</select>
		 <customwhere name="customwhere1" prepend="and">
			<field prepend='and' operator='like' colname='SYNCDATE' value='#time#' /> 
		</customwhere> 
		<customwhere name="customwhere2" prepend="and">
			<field prepend='and' operator='like' colname='ACPT_TIME' value='#time#' /> 
		</customwhere>  

	</sqlquery>
	

<!-- 家庭宽带网络质量（集团） -->
	<sqlquery name="SQL_TS_JTWLZL.query">
		<select>
       <![CDATA[
      SELECT /*COUNT*/ * /*COUNT*/ FROM (
	SELECT   nvl(tk.AREA_NAME,'合计') AREA_NAME,
NVL(SUM(GY_COMPLANTS),0)	GY_COMPLANTS,
NVL(SUM(ZX_COMPLANTS),0)	ZX_COMPLANTS,
NVL(SUM(XY_COMPLANTS),0)	XY_COMPLANTS,
NVL(SUM(XYSJ_COMPLANTS),0)	XYSJ_COMPLANTS  FROM (
	SELECT  
	tall.AREA_NAME AREA_NAME,
	NVL(tall.GY_COMPLAINTS,0) GY_COMPLANTS,
	NVL(ta.ZX_COMPLANTS,0) ZX_COMPLANTS,
	NVL(tb.XY_COMPLANTS,0) XY_COMPLANTS,
	NVL(tc.XYSJ_COMPLANTS,0) XYSJ_COMPLANTS 
FROM
	(
	SELECT
		AREA_NAME,
		SUM( GY_COMPLAINTS ) GY_COMPLAINTS 
	FROM
		(
		SELECT
			to_char( to_date( acpt_time, 'yyyy-MM-dd hh24:mi:ss' ), 'yyyy-mm-dd' ) AS ACPT_TIME,
			1 AS GY_COMPLAINTS,
		CASE WHEN AREA_NAME = '全省' OR AREA_NAME = '异地' THEN '其他' ELSE AREA_NAME END AS AREA_NAME 
			FROM
				(
				SELECT
					a12 AS name,
					area_name,
					to_char( to_date( STATIS_DATE, 'yyyy-MM-dd hh24:mi:ss' ), 'yyyy-mm-dd' ) AS acpt_time 
				FROM
					NGCS_WF_CMPLNTS_REQST_DETAIL 
				WHERE
					( IF_TS = '0' AND A02 IN ( '移动业务', '增值业务', '家庭业务', '集团业务' ) OR ( A02 = '服务类' AND A03 = '客户投诉' ) ) 
					AND (a12 LIKE '家庭业务→网络质量→家庭宽带%')   $customwhere1$  UNION ALL
				SELECT
					SRV_REQST_TYPE_FULL_NM AS name,
					area_name,
					to_char( to_date( STATIS_DATE, 'yyyy-MM-dd hh24:mi:ss' ), 'yyyy-mm-dd' ) AS acpt_time 
				FROM
					NGCS_WF_CMPLNTS_ARC_DETAIL 
				WHERE
					SRV_REQST_TYPE_FULL_NM LIKE '家庭业务→网络质量→家庭宽带%'   $customwhere1$
				)
			)  
			
		GROUP BY
			AREA_NAME 
		) tall
		LEFT JOIN (
		SELECT
			AREA_NAME,
			SUM( ZX_COMPLAINTS ) ZX_COMPLANTS 
		FROM
			(
			SELECT
				to_char( to_date( STATIS_DATE, 'yyyy-MM-dd hh24:mi:ss' ), 'yyyy-mm-dd' ) AS ACPT_TIME,
			  1 AS ZX_COMPLAINTS,
			  CASE WHEN AREA_NAME = '全省' OR AREA_NAME = '异地' THEN '其他' ELSE AREA_NAME END AS AREA_NAME 
				FROM
					NGCS_WF_CMPLNTS_REQST_DETAIL 
				WHERE
					( IF_TS = '0' AND A02 IN ( '移动业务', '增值业务', '家庭业务', '集团业务' ) OR ( A02 = '服务类' AND A03 = '客户投诉' ) )
					 AND (a12 LIKE '家庭业务→网络质量→家庭宽带%')   $customwhere1$
				)
			GROUP BY
				AREA_NAME 
			) ta  ON ta.AREA_NAME = tall.AREA_NAME
			LEFT JOIN (
		SELECT AREA_NAME,
			   SUM( XY_COMPLANTS ) XY_COMPLANTS 
		 FROM (
			SELECT
			to_char( to_date( STATIS_DATE, 'yyyy-MM-dd hh24:mi:ss' ), 'yyyy-mm-dd' ) AS ACPT_TIME,
			CASE WHEN AREA_NAME = '全省' OR AREA_NAME = '异地' THEN '其他' ELSE AREA_NAME END AS AREA_NAME,
			1 AS XY_COMPLANTS 
				FROM
					NGCS_WF_CMPLNTS_ARC_DETAIL 
				WHERE
					SRV_REQST_TYPE_FULL_NM LIKE '家庭业务→网络质量→家庭宽带%'     $customwhere1$
					)
				GROUP BY
					AREA_NAME 
				) tb   ON tb.AREA_NAME = tall.AREA_NAME
				LEFT JOIN (
				SELECT AREA_NAME,
			   SUM( XYSJ_COMPLANTS ) XYSJ_COMPLANTS 
		 FROM (
				SELECT
				to_char( to_date( STATIS_DATE, 'yyyy-MM-dd hh24:mi:ss' ), 'yyyy-mm-dd' ) AS ACPT_TIME,
				    CASE WHEN AREA_NAME = '全省' OR AREA_NAME = '异地' THEN '其他' ELSE AREA_NAME END AS AREA_NAME,
						1 XYSJ_COMPLANTS 
					FROM
						NGCS_WF_CMPLNTS_ARC_DETAIL 
					WHERE
						SRV_REQST_TYPE_FULL_NM LIKE '家庭业务→网络质量→家庭宽带%'  $customwhere1$
						AND (
							ACPT_CHNL_NM IN ('（呼入）96180','信产部转办','信产部立案','总部转办','工信部化解','信产部清算司','信产部服务处','信产部立案返单','工信部咨询化解','集团热线','集团热线预处理','10080短信自助','10080邮箱自助','10080邮箱','10080服务监督','全省携号转网','民心网跟踪件','民心网咨询','民心网','内部客户来函','外部客户来函','省内来函来访','客户来访','省315','市315','315及行风咨询','315平台','中消协电商消费维权直通车','中消协转','质量万里行','总部督办','总部','综合部敏感信息','巡视整改','企业自查','CEO信箱','12300','12321举报受理中心','12300咨询','管局局长信箱','12300网站','12300电话','管局局长信箱转办','12300网站转办','12300电话转办','政民互动平台','政风行风','政民互动平台跟踪件','纠风热线' ) 
						) )
					GROUP BY
					AREA_NAME 
	) tc  ON tall.AREA_NAME = tc.AREA_NAME) a 
	RIGHT JOIN (
			SELECT   CASE					
					WHEN
						AREA_NAME = '全省' 
						OR AREA_NAME = '异地' THEN
							'其他' ELSE AREA_NAME 
						END AS AREA_NAME,COUNT(AREA_NAME) FROM NGCS_WF_CMPLNTS_REQST_DETAIL GROUP BY AREA_NAME
	) tk ON a.area_name=tk.area_name
 group by rollup(tk.AREA_NAME)) order by /*ORDERBY*/ instr('沈阳,大连,鞍山,抚顺,本溪,丹东,锦州,营口,阜新,辽阳,铁岭,朝阳,盘锦,葫芦,其他,合计',substr(AREA_NAME,0,2))
   ]]>
		</select>		
		<customwhere name="customwhere1" prepend="and">
			<field prepend='and' operator='like' colname='STATIS_DATE' value='#time#' />
		</customwhere>
		<!-- <customwhere name="customwhere1" prepend="and">
			<field prepend='and' operator='like' colname='ACPT_TIME' value='#threeMonth#' />
		</customwhere> -->
	</sqlquery>
	
	
	
	<!-- 4G手机上网（集团） -->
	<sqlquery name="SQL_TS_SJSW.query">
		<select>
       <![CDATA[
		SELECT /*COUNT*/ * /*COUNT*/ FROM (
SELECT   nvl(tk.AREA_NAME,'合计') AREA_NAME,
NVL(SUM(GY_COMPLANTS),0)	GY_COMPLANTS,
NVL(SUM(ZX_COMPLANTS),0)	ZX_COMPLANTS,
NVL(SUM(XY_COMPLANTS),0)	XY_COMPLANTS,
NVL(SUM(XYSJ_COMPLANTS),0)	XYSJ_COMPLANTS FROM (
	SELECT  
	tall.AREA_NAME AREA_NAME,
	NVL(tall.GY_COMPLAINTS,0) GY_COMPLANTS,
	NVL(ta.ZX_COMPLANTS,0) ZX_COMPLANTS,
	NVL(tb.XY_COMPLANTS,0) XY_COMPLANTS,
	NVL(tc.XYSJ_COMPLANTS,0) XYSJ_COMPLANTS 
FROM
	(
	SELECT
		AREA_NAME,
		SUM( GY_COMPLAINTS ) GY_COMPLAINTS 
	FROM
		(
		SELECT
			to_char( to_date( acpt_time, 'yyyy-MM-dd hh24:mi:ss' ), 'yyyy-mm-dd' ) AS ACPT_TIME,
			1 AS GY_COMPLAINTS,
		CASE WHEN AREA_NAME = '全省' OR AREA_NAME = '异地' THEN '其他' ELSE AREA_NAME END AS AREA_NAME 
			FROM
				(
				SELECT
					a12 AS name,
					area_name,
					to_char( to_date( STATIS_DATE, 'yyyy-MM-dd hh24:mi:ss' ), 'yyyy-mm-dd' ) AS ACPT_TIME
				FROM
					NGCS_WF_CMPLNTS_REQST_DETAIL 
				WHERE
					( IF_TS = '0' AND A02 IN ( '移动业务', '增值业务', '家庭业务', '集团业务' ) OR ( A02 = '服务类' AND A03 = '客户投诉' ) ) 
					AND (a12 LIKE '移动业务→网络质量→手机上网（4G）%' ) $customwhere1$ UNION ALL
				SELECT
					SRV_REQST_TYPE_FULL_NM AS name,
					area_name,
					to_char( to_date( STATIS_DATE, 'yyyy-MM-dd hh24:mi:ss' ), 'yyyy-mm-dd' ) AS ACPT_TIME
				FROM
					NGCS_WF_CMPLNTS_ARC_DETAIL 
				WHERE
					SRV_REQST_TYPE_FULL_NM LIKE '移动业务→网络质量→手机上网（4G）%'  $customwhere1$
				)
			)  
			
		GROUP BY
			AREA_NAME 
		) tall
		LEFT JOIN (
		SELECT
			AREA_NAME,
			SUM( ZX_COMPLAINTS ) ZX_COMPLANTS 
		FROM
			(
			SELECT
				to_char( to_date( STATIS_DATE, 'yyyy-MM-dd hh24:mi:ss' ), 'yyyy-mm-dd' ) AS ACPT_TIME,
			  1 AS ZX_COMPLAINTS,
			  CASE WHEN AREA_NAME = '全省' OR AREA_NAME = '异地' THEN '其他' ELSE AREA_NAME END AS AREA_NAME 
				FROM
					NGCS_WF_CMPLNTS_REQST_DETAIL 
				WHERE
					( IF_TS = '0' AND A02 IN ( '移动业务', '增值业务', '家庭业务', '集团业务' ) OR ( A02 = '服务类' AND A03 = '客户投诉' ) ) 
					AND (a12 LIKE '移动业务→网络质量→手机上网（4G）%' ) $customwhere1$
				) 
			GROUP BY
				AREA_NAME 
			) ta  ON ta.AREA_NAME = tall.AREA_NAME
			LEFT JOIN (
		SELECT AREA_NAME,
			   SUM( XY_COMPLANTS ) XY_COMPLANTS 
		 FROM (
			SELECT
			to_char( to_date( STATIS_DATE, 'yyyy-MM-dd hh24:mi:ss' ), 'yyyy-mm-dd' ) AS ACPT_TIME,
			CASE WHEN AREA_NAME = '全省' OR AREA_NAME = '异地' THEN '其他' ELSE AREA_NAME END AS AREA_NAME,
			1 AS XY_COMPLANTS 
				FROM
					NGCS_WF_CMPLNTS_ARC_DETAIL 
				WHERE
					SRV_REQST_TYPE_FULL_NM LIKE '移动业务→网络质量→手机上网（4G）%'   $customwhere1$
					)
				GROUP BY
					AREA_NAME 
				) tb   ON tb.AREA_NAME = tall.AREA_NAME
				LEFT JOIN (
				SELECT AREA_NAME,
			   SUM( XYSJ_COMPLANTS ) XYSJ_COMPLANTS 
		 FROM (
				SELECT
				to_char( to_date( STATIS_DATE, 'yyyy-MM-dd hh24:mi:ss' ), 'yyyy-mm-dd' ) AS ACPT_TIME,
				    CASE WHEN AREA_NAME = '全省' OR AREA_NAME = '异地' THEN '其他' ELSE AREA_NAME END AS AREA_NAME,
						1 XYSJ_COMPLANTS 
					FROM
						NGCS_WF_CMPLNTS_ARC_DETAIL 
					WHERE
						SRV_REQST_TYPE_FULL_NM LIKE '移动业务→网络质量→手机上网（4G）%'    $customwhere1$
						AND (
							ACPT_CHNL_NM IN ('（呼入）96180','信产部转办','信产部立案','总部转办','工信部化解','信产部清算司','信产部服务处','信产部立案返单','工信部咨询化解','集团热线','集团热线预处理','10080短信自助','10080邮箱自助','10080邮箱','10080服务监督','全省携号转网','民心网跟踪件','民心网咨询','民心网','内部客户来函','外部客户来函','省内来函来访','客户来访','省315','市315','315及行风咨询','315平台','中消协电商消费维权直通车','中消协转','质量万里行','总部督办','总部','综合部敏感信息','巡视整改','企业自查','CEO信箱','12300','12321举报受理中心','12300咨询','管局局长信箱','12300网站','12300电话','管局局长信箱转办','12300网站转办','12300电话转办','政民互动平台','政风行风','政民互动平台跟踪件','纠风热线' ) 
						) )
					GROUP BY
					AREA_NAME 
	) tc  ON tall.AREA_NAME = tc.AREA_NAME) a 
	RIGHT JOIN (
			SELECT   CASE					
					WHEN
						AREA_NAME = '全省' 
						OR AREA_NAME = '异地' THEN
							'其他' ELSE AREA_NAME 
						END AS AREA_NAME,COUNT(AREA_NAME) FROM NGCS_WF_CMPLNTS_REQST_DETAIL GROUP BY AREA_NAME
	) tk ON a.area_name=tk.area_name
 group by rollup(tk.AREA_NAME)) order by /*ORDERBY*/ instr('沈阳,大连,鞍山,抚顺,本溪,丹东,锦州,营口,阜新,辽阳,铁岭,朝阳,盘锦,葫芦,其他,合计',substr(AREA_NAME,0,2))
	          ]]>
		</select>		
		<customwhere name="customwhere1" prepend="and">
			<field prepend='and' operator='like' colname='STATIS_DATE' value='#time#' />
		</customwhere>
		<!-- <customwhere name="customwhere1" prepend="and">
			<field prepend='and' operator='like' colname='ACPT_TIME' value='#threeMonth#' />
		</customwhere> -->
	</sqlquery>
	
	
	
	
	<!-- 业务营销 -->
	<sqlquery name="SQL_TS_BM.query">
		<select>
       <![CDATA[
	SELECT /*COUNT*/ * /*COUNT*/ FROM (
SELECT   nvl(tk.AREA_NAME,'合计') AREA_NAME,
NVL(SUM(GY_COMPLANTS),0)	GY_COMPLANTS,
NVL(SUM(ZX_COMPLANTS),0)	ZX_COMPLANTS,
NVL(SUM(XY_COMPLANTS),0)	XY_COMPLANTS,
NVL(SUM(XYSJ_COMPLANTS),0)	XYSJ_COMPLANTS FROM (
	SELECT  
	tall.AREA_NAME AREA_NAME,
	NVL(tall.GY_COMPLAINTS,0) GY_COMPLANTS,
	NVL(ta.ZX_COMPLANTS,0) ZX_COMPLANTS,
	NVL(tb.XY_COMPLANTS,0) XY_COMPLANTS,
	NVL(tc.XYSJ_COMPLANTS,0) XYSJ_COMPLANTS 
FROM
	(
	SELECT
		AREA_NAME,
		SUM( GY_COMPLAINTS ) GY_COMPLAINTS 
	FROM
		(
		SELECT
			to_char( to_date( acpt_time, 'yyyy-MM-dd hh24:mi:ss' ), 'yyyy-mm-dd' ) AS ACPT_TIME,
			1 AS GY_COMPLAINTS,
		CASE WHEN AREA_NAME = '全省' OR AREA_NAME = '异地' THEN '其他' ELSE AREA_NAME END AS AREA_NAME 
			FROM
				(
				SELECT
					a12 AS name,
					area_name,
					to_char( to_date( STATIS_DATE, 'yyyy-MM-dd hh24:mi:ss' ), 'yyyy-mm-dd' ) AS acpt_time 
				FROM
					NGCS_WF_CMPLNTS_REQST_DETAIL 
				WHERE
					( IF_TS = '0' AND A02 IN ( '移动业务', '增值业务', '家庭业务', '集团业务' ) OR ( A02 = '服务类' AND A03 = '客户投诉' ) ) 
					AND (A12 LIKE '家庭业务→业务营销%'  
					OR A12 LIKE '集团业务→业务营销%'  
					OR A12  LIKE '移动业务→业务营销%' 
					OR A12 LIKE '增值业务→业务营销%'  )  $customwhere1$  UNION ALL
				SELECT
					SRV_REQST_TYPE_FULL_NM AS name,
					area_name,
					to_char( to_date( STATIS_DATE, 'yyyy-MM-dd hh24:mi:ss' ), 'yyyy-mm-dd' ) AS acpt_time 
				FROM
					NGCS_WF_CMPLNTS_ARC_DETAIL 
				WHERE
					SRV_REQST_TYPE_FULL_NM LIKE '家庭业务→业务营销%'  
					OR SRV_REQST_TYPE_FULL_NM LIKE '集团业务→业务营销%'  
					OR SRV_REQST_TYPE_FULL_NM  LIKE '移动业务→业务营销%' 
					OR SRV_REQST_TYPE_FULL_NM LIKE '增值业务→业务营销%'  $customwhere1$
				)
			)  
			
		GROUP BY
			AREA_NAME 
		) tall
		LEFT JOIN (
		SELECT
			AREA_NAME,
			SUM( ZX_COMPLAINTS ) ZX_COMPLANTS 
		FROM
			(
			SELECT
				to_char( to_date( STATIS_DATE, 'yyyy-MM-dd hh24:mi:ss' ), 'yyyy-mm-dd' ) AS ACPT_TIME,
			  1 AS ZX_COMPLAINTS,
			  CASE WHEN AREA_NAME = '全省' OR AREA_NAME = '异地' THEN '其他' ELSE AREA_NAME END AS AREA_NAME 
				FROM
					NGCS_WF_CMPLNTS_REQST_DETAIL 
				WHERE
					( IF_TS = '0' AND A02 IN ( '移动业务', '增值业务', '家庭业务', '集团业务' ) OR ( A02 = '服务类' AND A03 = '客户投诉' ) ) AND (A12 LIKE '家庭业务→业务营销%'  
					OR A12 LIKE '集团业务→业务营销%'  
					OR A12  LIKE '移动业务→业务营销%' 
					OR A12 LIKE '增值业务→业务营销%'   ) $customwhere1$
				) where 1=1 
			GROUP BY
				AREA_NAME 
			) ta  ON ta.AREA_NAME = tall.AREA_NAME
			LEFT JOIN (
		SELECT AREA_NAME,
			   SUM( XY_COMPLANTS ) XY_COMPLANTS 
		 FROM (
			SELECT
			to_char( to_date( STATIS_DATE, 'yyyy-MM-dd hh24:mi:ss' ), 'yyyy-mm-dd' ) AS ACPT_TIME,
			CASE WHEN AREA_NAME = '全省' OR AREA_NAME = '异地' THEN '其他' ELSE AREA_NAME END AS AREA_NAME,
			1 AS XY_COMPLANTS 
				FROM
					NGCS_WF_CMPLNTS_ARC_DETAIL 
				WHERE
				SRV_REQST_TYPE_FULL_NM LIKE '家庭业务→业务营销%'  
					OR SRV_REQST_TYPE_FULL_NM LIKE '集团业务→业务营销%'  
					OR SRV_REQST_TYPE_FULL_NM  LIKE '移动业务→业务营销%' 
					OR SRV_REQST_TYPE_FULL_NM LIKE '增值业务→业务营销%'   $customwhere1$
					)
				GROUP BY
					AREA_NAME 
				) tb   ON tb.AREA_NAME = tall.AREA_NAME
				LEFT JOIN (
				SELECT AREA_NAME,
			   SUM( XYSJ_COMPLANTS ) XYSJ_COMPLANTS 
		 FROM (
				SELECT
				to_char( to_date( STATIS_DATE, 'yyyy-MM-dd hh24:mi:ss' ), 'yyyy-mm-dd' ) AS ACPT_TIME,
				    CASE WHEN AREA_NAME = '全省' OR AREA_NAME = '异地' THEN '其他' ELSE AREA_NAME END AS AREA_NAME,
						1 XYSJ_COMPLANTS 
					FROM
						NGCS_WF_CMPLNTS_ARC_DETAIL 
					WHERE
					SRV_REQST_TYPE_FULL_NM LIKE '家庭业务→业务营销%'  
					OR SRV_REQST_TYPE_FULL_NM LIKE '集团业务→业务营销%'  
					OR SRV_REQST_TYPE_FULL_NM  LIKE '移动业务→业务营销%' 
					OR SRV_REQST_TYPE_FULL_NM LIKE '增值业务→业务营销%'   
						AND (
							ACPT_CHNL_NM IN ('（呼入）96180','信产部转办','信产部立案','总部转办','工信部化解','信产部清算司','信产部服务处','信产部立案返单',
							'工信部咨询化解','集团热线','集团热线预处理','10080短信自助','10080邮箱自助','10080邮箱','10080服务监督','全省携号转网',
							'民心网跟踪件','民心网咨询','民心网','内部客户来函','外部客户来函','省内来函来访','客户来访','省315','市315','315及行风咨询',
							'315平台','中消协电商消费维权直通车','中消协转','质量万里行','总部督办','总部','综合部敏感信息','巡视整改','企业自查','CEO信箱',
							'12300','12321举报受理中心','12300咨询','管局局长信箱','12300网站','12300电话','管局局长信箱转办','12300网站转办',
							'12300电话转办','政民互动平台','政风行风','政民互动平台跟踪件','纠风热线' ) 
						)  $customwhere1$ )
					GROUP BY
					AREA_NAME 
	) tc  ON tall.AREA_NAME = tc.AREA_NAME) a 
	RIGHT JOIN (
			SELECT   CASE					
					WHEN
						AREA_NAME = '全省' 
						OR AREA_NAME = '异地' THEN
							'其他' ELSE AREA_NAME 
						END AS AREA_NAME,COUNT(AREA_NAME) FROM NGCS_WF_CMPLNTS_REQST_DETAIL GROUP BY AREA_NAME
	) tk ON a.area_name=tk.area_name
 group by rollup(tk.AREA_NAME)) order by /*ORDERBY*/ instr('沈阳,大连,鞍山,抚顺,本溪,丹东,锦州,营口,阜新,辽阳,铁岭,朝阳,盘锦,葫芦,其他,合计',substr(AREA_NAME,0,2))
	          ]]>
		</select>		
		<customwhere name="customwhere1" prepend="and">
			<field prepend='and' operator='like' colname='STATIS_DATE' value='#time#' />
		</customwhere>
		<!-- <customwhere name="customwhere1" prepend="and">
			<field prepend='and' operator='like' colname='ACPT_TIME' value='#threeMonth#' />
		</customwhere> -->
	</sqlquery>
	
	
	
	
	<!-- 不知情定制 -->
	<sqlquery name="SQL_TS_UN.query">
		<select>
       <![CDATA[
			
		SELECT /*COUNT*/ * /*COUNT*/  FROM (
SELECT 
 ta.NAME AS AREA_NAME ,
	(NVL(tb.ZX_COMPLANTS,0)+NVL(tc.XY_COMPLANTS,0)) AS GY_COMPLANTS,
	NVL(tb.ZX_COMPLANTS,0) ZX_COMPLANTS,
	NVL(tc.XY_COMPLANTS,0) XY_COMPLANTS,
	NVL(tc.XYSJ_COMPLANTS,0) XYSJ_COMPLANTS
FROM 
(select regexp_substr('沈阳市,大连市,鞍山市,抚顺市,本溪市,丹东市,锦州市,营口市,阜新市,辽阳市,铁岭市,朝阳市,盘锦市,葫芦岛市,其他,合计', '[^,]+', 1, rownum) name from dual connect by rownum <= length('沈阳,大连,鞍山,抚顺,本溪,丹东,锦州,营口,阜新,辽阳,铁岭,朝阳,盘锦,葫芦,其他,合计') - length(replace('沈阳,大连,鞍山,抚顺,本溪,丹东,锦州,营口,阜新,辽阳,铁岭,朝阳,盘锦,葫芦,其他,合计', ',')) + 1
 ) ta

LEFT JOIN 

(SELECT 
	nvl ( (CASE WHEN AREA_NAME = '全省' OR AREA_NAME = '异地' OR AREA_NAME = '其他' THEN '其他' ELSE AREA_NAME END),'合计' ) AS AREA_NAME,
	SUM(1) AS ZX_COMPLANTS
	FROM NGCS_WF_CMPLNTS_REQST_DETAIL  WHERE (IF_TS='0'AND A02 IN ('移动业务','增值业务','家庭业务','集团业务') OR (A02 = '服务类' AND A03 ='客户投诉')) AND ((A07 IN ( '不知情办理', '不知情定制', '不知情办理、取消或变更', '不知情办理/退订', '不知情开通或取消', '不知情入网', '对查询到的业务订购关系不认同', '未订购业务，但被扣费', '没有订购关系，但被扣费' )) OR ( A08 IN ( '不知情办理', '不知情定制', '不知情办理、取消或变更', '不知情办理/退订', '不知情开通或取消', '不知情入网', '对查询到的业务订购关系不认同', '未订购业务，但被扣费', '没有订购关系，但被扣费'))		
		) $customwhere1$  GROUP BY rollup(CASE WHEN AREA_NAME = '全省' OR AREA_NAME = '异地' OR AREA_NAME = '其他' THEN '其他' ELSE AREA_NAME END) ) tb ON ta.NAME=tb.AREA_NAME
		
LEFT JOIN (
	SELECT
nvl ( (CASE WHEN AREA_NAME = '全省' OR AREA_NAME = '异地' OR AREA_NAME = '其他' THEN '其他' ELSE AREA_NAME END),'合计' ) AS AREA_NAME,
				SUM(1) AS XY_COMPLANTS ,SUM(  CASE WHEN (ACPT_CHNL_NM IN (
					'（呼入）96180','信产部转办','信产部立案','总部转办','工信部化解','信产部清算司','信产部服务处','信产部立案返单','工信部咨询化解','集团热线','集团热线预处理','10080短信自助','10080邮箱自助','10080邮箱','10080服务监督','全省携号转网','民心网跟踪件','民心网咨询','民心网','内部客户来函','外部客户来函','省内来函来访','客户来访','省315','市315','315及行风咨询','315平台','中消协电商消费维权直通车','中消协转','质量万里行','总部督办','总部','综合部敏感信息','巡视整改','企业自查','CEO信箱','12300','12321举报受理中心','12300咨询','管局局长信箱','12300网站','12300电话','管局局长信箱转办','12300网站转办','12300电话转办','政民互动平台','政风行风','政民互动平台跟踪件','纠风热线' ))	 THEN 1 ELSE 0 END ) AS XYSJ_COMPLANTS
					
					FROM NGCS_WF_CMPLNTS_ARC_DETAIL WHERE ((A07 IN ( '不知情办理', '不知情定制', '不知情办理、取消或变更', '不知情办理/退订', '不知情开通或取消', '不知情入网', '对查询到的业务订购关系不认同', '未订购业务，但被扣费', '没有订购关系，但被扣费' )) OR ( A08 IN ( '不知情办理', '不知情定制', '不知情办理、取消或变更', '不知情办理/退订', '不知情开通或取消', '不知情入网', '对查询到的业务订购关系不认同', '未订购业务，但被扣费', '没有订购关系，但被扣费'))		
		)   $customwhere1$  GROUP BY rollup(CASE WHEN AREA_NAME = '全省' OR AREA_NAME = '异地' OR AREA_NAME = '其他' THEN '其他' ELSE AREA_NAME END)
) tc ON ta.NAME=tc.AREA_NAME ) order by /*ORDERBY*/ instr('沈阳,大连,鞍山,抚顺,本溪,丹东,锦州,营口,阜新,辽阳,铁岭,朝阳,盘锦,葫芦,其他,合计',substr(area_name,0,2))
		
	          ]]>
		</select>	
		<customwhere name="customwhere1" prepend="and">
			<field prepend='and' operator='like' colname='STATIS_DATE' value='#time#' />
		</customwhere>
		<!-- <customwhere name="customwhere1" prepend="and">
			<field prepend='and' operator='like' colname='ACPT_TIME' value='#threeMonth#' />
		</customwhere> -->
	</sqlquery>
</sql-group>